<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://songhanghang.github.io</id>
    <title>å®‹èˆª</title>
    <updated>2019-08-22T07:45:50.027Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://songhanghang.github.io"/>
    <link rel="self" href="https://songhanghang.github.io/atom.xml"/>
    <subtitle>ç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ</subtitle>
    <logo>https://songhanghang.github.io/images/avatar.png</logo>
    <icon>https://songhanghang.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, å®‹èˆª</rights>
    <entry>
        <title type="html"><![CDATA[Comparatorä¸­Long Cast Intå¼•å‘çš„è¡€æ¡ˆ]]></title>
        <id>https://songhanghang.github.io/post/comparator-zhong-long-cast-int-yin-fa-de-xie-an</id>
        <link href="https://songhanghang.github.io/post/comparator-zhong-long-cast-int-yin-fa-de-xie-an">
        </link>
        <updated>2019-08-21T12:30:52.000Z</updated>
        <summary type="html"><![CDATA[<h2 id="å…ˆçœ‹ä»£ç ">å…ˆçœ‹ä»£ç </h2>
<pre><code class="language-java">Collections.sort(list, new Comparator&lt;Long&gt;() {
                @Override
                public int compare(Long time1, Long time2) {
                    return (int) (time1 - time2);
                }
            });
</code></pre>
<p>è¿™ä¹ˆçŸ­å‡ è¡Œï¼Œçœ‹ä¸Šå»å¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜ï¼Ÿ<br>
ç»„å†…Code Reviewä¹Ÿæœªå‘ç°é—®é¢˜ï¼Œä½†æ˜¯ä¸Šçº¿ä¸€æ®µæ—¶é—´åæ”¶åˆ°å¾ˆå¤šå¼‚å¸¸!</p>
]]></summary>
        <content type="html"><![CDATA[<h2 id="å…ˆçœ‹ä»£ç ">å…ˆçœ‹ä»£ç </h2>
<pre><code class="language-java">Collections.sort(list, new Comparator&lt;Long&gt;() {
                @Override
                public int compare(Long time1, Long time2) {
                    return (int) (time1 - time2);
                }
            });
</code></pre>
<p>è¿™ä¹ˆçŸ­å‡ è¡Œï¼Œçœ‹ä¸Šå»å¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜ï¼Ÿ<br>
ç»„å†…Code Reviewä¹Ÿæœªå‘ç°é—®é¢˜ï¼Œä½†æ˜¯ä¸Šçº¿ä¸€æ®µæ—¶é—´åæ”¶åˆ°å¾ˆå¤šå¼‚å¸¸!</p>
<!-- more --> 
<pre><code class="language-java">Caused by: java.lang.IllegalArgumentException: Comparison method violates its general contract!
    at java.util.TimSort.mergeHi(TimSort.java:899)
    at java.util.TimSort.mergeAt(TimSort.java:516)
    at java.util.TimSort.mergeCollapse(TimSort.java:441)
    at java.util.TimSort.sort(TimSort.java:245)
    at java.util.Arrays.sort(Arrays.java:1498)
    at java.util.ArrayList.sort(ArrayList.java:1470)
    at java.util.Collections.sort(Collections.java:201)
</code></pre>
<p>ç¿»è¯‘è¿‡æ¥<br>
æ¯”è¾ƒæ–¹æ³•è¿åäº†å…¶æ€»åˆåŒï¼ï¼ï¼</p>
<p>åˆåŒåœ¨å“ªï¼Ÿ<br>
Comparatorä¸­compareæœ‰å¦‚ä¸‹æè¿°ã€‚</p>
<pre><code>**
     * Compares its two arguments for order.  Returns a negative integer,
     * zero, or a positive integer as the first argument is less than, equal
     * to, or greater than the second.&lt;p&gt;
     *
     * In the foregoing description, the notation
     * &lt;tt&gt;sgn(&lt;/tt&gt;&lt;i&gt;expression&lt;/i&gt;&lt;tt&gt;)&lt;/tt&gt; designates the mathematical
     * &lt;i&gt;signum&lt;/i&gt; function, which is defined to return one of &lt;tt&gt;-1&lt;/tt&gt;,
     * &lt;tt&gt;0&lt;/tt&gt;, or &lt;tt&gt;1&lt;/tt&gt; according to whether the value of
     * &lt;i&gt;expression&lt;/i&gt; is negative, zero or positive.&lt;p&gt;
     *
     * The implementor must ensure that &lt;tt&gt;sgn(compare(x, y)) ==
     * -sgn(compare(y, x))&lt;/tt&gt; for all &lt;tt&gt;x&lt;/tt&gt; and &lt;tt&gt;y&lt;/tt&gt;.  (This
     * implies that &lt;tt&gt;compare(x, y)&lt;/tt&gt; must throw an exception if and only
     * if &lt;tt&gt;compare(y, x)&lt;/tt&gt; throws an exception.)&lt;p&gt;
     *
     * The implementor must also ensure that the relation is transitive:
     * &lt;tt&gt;((compare(x, y)&amp;gt;0) &amp;amp;&amp;amp; (compare(y, z)&amp;gt;0))&lt;/tt&gt; implies
     * &lt;tt&gt;compare(x, z)&amp;gt;0&lt;/tt&gt;.&lt;p&gt;
     *
     * Finally, the implementor must ensure that &lt;tt&gt;compare(x, y)==0&lt;/tt&gt;
     * implies that &lt;tt&gt;sgn(compare(x, z))==sgn(compare(y, z))&lt;/tt&gt; for all
     * &lt;tt&gt;z&lt;/tt&gt;.&lt;p&gt;
     *
     * It is generally the case, but &lt;i&gt;not&lt;/i&gt; strictly required that
     * &lt;tt&gt;(compare(x, y)==0) == (x.equals(y))&lt;/tt&gt;.  Generally speaking,
     * any comparator that violates this condition should clearly indicate
     * this fact.  The recommended language is &quot;Note: this comparator
     * imposes orderings that are inconsistent with equals.&quot;
</code></pre>
<p>å¤§è‡´æ„æ€å°±æ˜¯ï¼Œä½ å¿…é¡»ä¿è¯è‡ªåæ€§ï¼Œä¼ é€’æ€§ï¼Œæœ‰åºæ€§ã€‚</p>
<ol>
<li>è‡ªåæ€§ï¼šxï¼Œy çš„æ¯”è¾ƒç»“æœå’Œ yï¼Œx çš„æ¯”è¾ƒç»“æœç›¸åã€‚</li>
<li>ä¼ é€’æ€§ï¼šx&gt;y,y&gt;z,åˆ™ x&gt;zã€‚</li>
<li>å¯¹ç§°æ€§ï¼šx=y,åˆ™ x,z æ¯”è¾ƒç»“æœå’Œ yï¼Œz æ¯”è¾ƒç»“æœç›¸åŒã€‚</li>
</ol>
<p>é‚£ä¹ˆæˆ‘åˆ°åº•è¿åäº†é‚£æ¡åˆåŒäº†ï¼Ÿ<br>
å”¯ä¸€èƒ½æ€€ç–‘çš„ä¹Ÿåªæœ‰ long cast to int äº†ï¼</p>
<p>å…ˆçœ‹ä¸‹ä¸¤ç§ç±»å‹å–å€¼èŒƒå›´</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>æœ€å¤§å€¼</th>
<th>æœ€å°å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>2^31 - 1 = 2147483647</td>
<td>-2^31 = -2147483648</td>
</tr>
<tr>
<td>long</td>
<td>2^63 - 1 = 9223372036854775807</td>
<td>-2^63 = -9223372036854775808</td>
</tr>
</tbody>
</table>
<p>å¼€å§‹æ‰¾èŒ¬æ¸¸æˆ...<br>
äºæ˜¯ä¹ï¼</p>
<pre><code class="language-java">long x = 2147483648l, long y = 0
(int) (x - y) = (int) 2147483648l = -2147483648
(int) (y - x) = (int) -2147483648l = -2147483648
</code></pre>
<p>ç¥å¥‡çš„x &lt; y &amp;&amp; y &lt; x æˆç«‹äº†ï¼<br>
åˆåŒç¬¬ä¸€æ¡è‡ªåæ€§è¿åï¼</p>
<p>å†æ¥</p>
<pre><code class="language-java">long x = 2147483648l, long y = 1l, long z = -1l
(int) (x - y) = (int) (2147483647l) = 2147483647
(int) (y - z) = (int) (2l) = 2l
(int) (x - z) = (int) (2147483649l) = -2147483647
</code></pre>
<p>ç¥å¥‡çš„x &gt; y &amp;&amp; y &gt; z &amp;&amp; x &lt; z ä¹Ÿæˆç«‹äº†ï¼</p>
<p>åˆåŒç¬¬äºŒæ¡ä¼ é€’æ€§è¿åï¼</p>
<p>è½»è½»æ¾æ¾å°±å†™äº†ä¸ªå¼¥å¤©å¤§bug!</p>
<p>æ‰¾åˆ°é—®é¢˜å°±å¥½è§£å†³äº†ï¼Œä¸ç”¨castå°±æ˜¯äº†ã€‚</p>
<pre><code class="language-java">Long.compare(time1, time2);
</code></pre>
<p>Long.compareå®ç°ä¹Ÿå¾ˆç®€å•, ç›´æ¥æ¯”è¾ƒå¤§å°ï¼Œè¿”å›å¯¹åº”intå€¼å³å¯ã€‚</p>
<pre><code class="language-java">public static int compare(long x, long y) {
        return (x &lt; y) ? -1 : ((x == y) ? 0 : 1);
    }
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>ç±»å‹å¼ºè½¬ï¼Œç²¾åº¦ä¸¢å¤±ä¼šæƒ¹ç¥¸ï¼ï¼ï¼<br>
ç±»å‹å¼ºè½¬éœ€è°¨æ…ï¼Œè°¨æ…ï¼Œå†è°¨æ…ï¼ï¼ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Android Studio 9-Patch Bug Miss Alpha Channel]]></title>
        <id>https://songhanghang.github.io/post/android-studio-9-patch-bug-miss-alpha-channel</id>
        <link href="https://songhanghang.github.io/post/android-studio-9-patch-bug-miss-alpha-channel">
        </link>
        <updated>2019-08-19T12:20:16.000Z</updated>
        <summary type="html"><![CDATA[<h2 id="é—®é¢˜">é—®é¢˜</h2>
<p>ç”¨ASåˆ›å»º9 Patchå›¾æ—¶ï¼Œå‘ç°æœ‰äº›å›¾ç‰‡è½¬æ¢åå¤±å»alphaä¿¡æ¯ï¼Œæ— æ³•ç¼–è¾‘æè¾¹ï¼</p>
<blockquote>
<p>res -&gt; drawale-xxhdpi -&gt;  target.png -&gt; å³é”® Create 9-Patch File</p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<h2 id="é—®é¢˜">é—®é¢˜</h2>
<p>ç”¨ASåˆ›å»º9 Patchå›¾æ—¶ï¼Œå‘ç°æœ‰äº›å›¾ç‰‡è½¬æ¢åå¤±å»alphaä¿¡æ¯ï¼Œæ— æ³•ç¼–è¾‘æè¾¹ï¼</p>
<blockquote>
<p>res -&gt; drawale-xxhdpi -&gt;  target.png -&gt; å³é”® Create 9-Patch File</p>
</blockquote>
<!-- more -->
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å¯¹æ¯”å‘ç°ï¼Œ</p>
<ol>
<li>è½¬æ¢åå¼‚å¸¸çš„.9å›¾ç‰‡ä¸º8-bit color æˆ–è€… 24-bit color, æ­£å¸¸çš„.9å›¾ç‰‡å‡ä¸º32-bit colorã€‚</li>
<li>å¦‚æœåŸå›¾ä¸º8-bit color æˆ–è€…24-bit color , è½¬æ¢åå¼‚å¸¸ã€‚ä½†æ˜¯åŸå›¾ä¸º32-bit color è½¬æ¢åä¹Ÿæœ‰å¯èƒ½å¼‚å¸¸ã€‚</li>
</ol>
<p>Googleå¹¶æœªæœ‰å¾ˆå¤šåé¦ˆï¼Œä»…æœ‰ä¸€ç¯‡ç±»ä¼¼é—®é¢˜<a href="https://stackoverflow.com/questions/25171838/9-patch-editor-android-studio-suddenly-black">https://stackoverflow.com/questions/25171838/9-patch-editor-android-studio-suddenly-black</a></p>
<h3 id="png-8-24-32åŒºåˆ«ä»‹ç»">PNG-8ã€24ã€32åŒºåˆ«ä»‹ç»</h3>
<p><a href="https://www.jianshu.com/p/31207790bad2">https://www.jianshu.com/p/31207790bad2</a></p>
<h2 id="å°è¯•è§£å†³">å°è¯•è§£å†³</h2>
<ol>
<li>Sketché‡æ–°åˆ‡å›¾åï¼Œè½¬æ¢.9æ­£å¸¸ï¼ˆæœªå‘ç°å›¾ç‰‡æœ‰ä»€ä¹ˆä¸åŒï¼‰</li>
<li>Sketché‡æ–°åˆ‡å›¾åï¼Œå†å‹ç¼©åï¼Œè½¬æ¢.9æ­£å¸¸</li>
<li>ä½¿ç”¨åœ¨çº¿å·¥å…·<a href="https://romannurik.github.io/AndroidAssetStudio/nine-patches.html#&amp;sourceDensity=320&amp;name=example">Simple nine-patch generator</a>è½¬æ¢8-bit color ,24-bit color ,32-bit coloråŸå›¾éƒ½èƒ½å¾—åˆ°æ­£å¸¸çš„.9å›¾ã€‚</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Android Studio 9-Patch ç›´æ¥è½¬æ¢å¯èƒ½ä¸¢å¤±ä½å›¾ä¿¡æ¯ï¼Œæ— æ³•è·å–32-bit color .9æ–‡ä»¶ã€‚<br>
æ¨èç›´æ¥ç”¨<a href="https://romannurik.github.io/AndroidAssetStudio/nine-patches.html#&amp;sourceDensity=320&amp;name=example">Simple nine-patch generator</a>è½¬æ¢å¼‚å¸¸å›¾ç‰‡ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Flutteråˆè¯†]]></title>
        <id>https://songhanghang.github.io/post/hello-gridea</id>
        <link href="https://songhanghang.github.io/post/hello-gridea">
        </link>
        <updated>2019-07-29T12:09:30.000Z</updated>
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" />
> å‚è€ƒï¼š 
> [Flutterä¸­æ–‡ç½‘: https://flutterchina.club](https://flutterchina.club/)
> [Flutterå®æˆ˜: https://book.flutterchina.club](https://book.flutterchina.club/)
> [Demo: https://github.com/songhanghang/flutter_news_demo](https://github.com/songhanghang/flutter_news_demo)
<h2 id="hybridç®€ä»‹">Hybridç®€ä»‹</h2>
<h3 id="h5-åŸç”Ÿ">H5 + åŸç”Ÿ</h3>
<p>WebViewæ¸²æŸ“ç•Œé¢ï¼Œæ€§èƒ½ä½“éªŒç›¸å¯¹Nativeè¾ƒå·®ã€‚</p>
<h3 id="jså¼€å‘-åŸç”Ÿ">JSå¼€å‘ + åŸç”Ÿ</h3>
<p>ä»£è¡¨æ¡†æ¶React Native, Weex, å¿«åº”ç”¨, åŸç†éƒ½æ˜¯JSå»æ˜ å°„ Android | IOS åŸç”Ÿæ§ä»¶ï¼ŒåŸç”Ÿæ¸²æŸ“é€Ÿåº¦å¿«äºH5ï¼Œå—é™äºJSè§£é‡Šæ‰§è¡Œï¼ŒåŠè°ƒç”¨æ¡¥å¼€é”€ï¼Œé€Ÿåº¦æ— æ³•è¿½èµ¶Nativeã€‚</p>
<h3 id="è‡ªç ”gui-åŸç”Ÿ">è‡ªç ”GUI + åŸç”Ÿ</h3>
<p>ä»£è¡¨æ¡†æ¶QT, Flutter, æ¸²æŸ“å¼•æ“ç›´æ¥å¯¹æ¥ä¸åŒå¹³å°ç³»ç»ŸAPI, å¯¹å¤–æä¾›ç»Ÿä¸€æ¥å£ï¼Œæ€§èƒ½å’ŒåŸç”Ÿæ¥è¿‘ï¼Œä½†æ˜¯åŠ¨æ€æ€§ä¸è¶³ï¼Œéœ€è¦ç¼–è¯‘å‘åŒ…ã€‚</p>
<blockquote>
<p>PSï¼šQTåœ¨æ¡Œé¢ç«¯åº”ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œä½†æ˜¯ç§»åŠ¨ç«¯å› å¼•æ“å¤§, C++å¼€å‘æ•ˆç‡ä½ï¼Œå‘å¤šï¼Œæ¨å‡ºå³å¤­æŠ˜ã€‚</p>
</blockquote>
<h2 id="flutterç™»åœº">Flutterç™»åœº</h2>
<p>Flutteræ˜¯Googleå‘å¸ƒçš„ä¸€ä¸ªç”¨äºåˆ›å»ºè·¨å¹³å°ã€é«˜æ€§èƒ½ç§»åŠ¨åº”ç”¨çš„æ¡†æ¶ã€‚Flutterå’ŒQT mobileä¸€æ ·ï¼Œéƒ½æ²¡æœ‰ä½¿ç”¨åŸç”Ÿæ§ä»¶ï¼Œç›¸åéƒ½å®ç°äº†ä¸€ä¸ªè‡ªç»˜å¼•æ“ï¼Œä½¿ç”¨è‡ªèº«çš„å¸ƒå±€ã€ç»˜åˆ¶ç³»ç»Ÿã€‚<br>
ä»¥ä¸‹æ˜¯å®˜ç½‘ä»‹ç»ï¼š</p>
<ol>
<li>
<p>å¿«é€Ÿå¼€å‘<br>
æ¯«ç§’çº§çš„çƒ­é‡è½½ï¼Œä¿®æ”¹åï¼Œæ‚¨çš„åº”ç”¨ç•Œé¢ä¼šç«‹å³æ›´æ–°ã€‚ä½¿ç”¨ä¸°å¯Œçš„ã€å®Œå…¨å¯å®šåˆ¶çš„widgetåœ¨å‡ åˆ†é’Ÿå†…æ„å»ºåŸç”Ÿç•Œé¢.</p>
</li>
<li>
<p>å¯Œæœ‰è¡¨ç°åŠ›å’Œçµæ´»çš„UI<br>
å¿«é€Ÿå‘å¸ƒèšç„¦äºåŸç”Ÿä½“éªŒçš„åŠŸèƒ½ã€‚åˆ†å±‚çš„æ¶æ„å…è®¸æ‚¨å®Œå…¨è‡ªå®šä¹‰ï¼Œä»è€Œå®ç°éš¾ä»¥ç½®ä¿¡çš„å¿«é€Ÿæ¸²æŸ“å’Œå¯Œæœ‰è¡¨ç°åŠ›ã€çµæ´»çš„è®¾è®¡ã€‚</p>
</li>
<li>
<p>åŸç”Ÿæ€§èƒ½<br>
FlutteråŒ…å«äº†è®¸å¤šæ ¸å¿ƒçš„widgetï¼Œå¦‚æ»šåŠ¨ã€å¯¼èˆªã€å›¾æ ‡å’Œå­—ä½“ç­‰ï¼Œè¿™äº›éƒ½å¯ä»¥åœ¨iOSå’ŒAndroidä¸Šè¾¾åˆ°åŸç”Ÿåº”ç”¨ä¸€æ ·çš„æ€§èƒ½ã€‚</p>
</li>
<li>
<p>è®¿é—®æœ¬åœ°åŠŸèƒ½å’ŒSDK<br>
é€šè¿‡å¹³å°ç›¸å…³çš„APIã€ç¬¬ä¸‰æ–¹SDKå’ŒåŸç”Ÿä»£ç è®©æ‚¨çš„åº”ç”¨å˜å¾—å¼ºå¤§æ˜“ç”¨ã€‚ Flutterå…è®¸æ‚¨å¤ç”¨ç°æœ‰çš„Javaã€Swiftæˆ–ObjCä»£ç ï¼Œè®¿é—®iOSå’ŒAndroidä¸Šçš„åŸç”Ÿç³»ç»ŸåŠŸèƒ½å’Œç³»ç»ŸSDKã€‚</p>
</li>
</ol>
<h2 id="flutteræ€æƒ³">Flutteræ€æƒ³</h2>
<h3 id="ç»„åˆ-é›†æˆ">ç»„åˆ &gt; é›†æˆ</h3>
<p>åœ¨Flutterä¸­ä¸€åˆ‡UIç›¸å…³æ“ä½œéƒ½æ˜¯Widgetï¼Œå¸ƒå±€ï¼Œå®¹å™¨ï¼Œæ‰‹åŠ¿ï¼Œæ»‘åŠ¨ï¼ŒåŠŸèƒ½éƒ½æ˜¯Widget, é€šè¿‡è‡ªç”±ç»„åˆè¿™äº›Widgetæ¥æ­å»ºåŠŸèƒ½ç•Œé¢ã€‚</p>
<h3 id="å“åº”å¼ç¼–ç¨‹">å“åº”å¼ç¼–ç¨‹</h3>
<p>å“åº”å¼ç¼–ç¨‹ä¸€å¥è¯æ€»ç»“å°±æ˜¯<code>æ•°æ®çŠ¶æ€æ”¹å˜åˆ™UIéšä¹‹è‡ªåŠ¨æ”¹å˜</code>ï¼ŒReact Nativeå’ŒDataBindingéƒ½æ˜¯è¯¥æ€æƒ³äº§ç‰©ï¼Œ åœ¨Flutterä¸­è¡¨ç°çš„æ›´åŠ æ·‹æ¼“å°½è‡´ã€‚æ•°æ®æ”¹å˜æ—¶é€šè¿‡setState() {}, é€šçŸ¥Flutter Frameworkæ‰§è¡ŒRebuild Widget -&gt; Update Element -&gt; Render UIã€‚</p>
<h2 id="flutteræ ¸å¿ƒåŸç†">Flutteræ ¸å¿ƒåŸç†</h2>
<h3 id="æ¡†æ¶åˆ†å±‚">æ¡†æ¶åˆ†å±‚</h3>
<p>Flutteræ¡†æ¶æ˜¯ä¸€ä¸ªåˆ†å±‚çš„ç»“æ„ï¼Œæ¯ä¸ªå±‚éƒ½å»ºç«‹åœ¨å‰ä¸€å±‚ä¹‹ä¸Šã€‚ä½¿ç”¨Skiaæ¸²æŸ“å¼•æ“ï¼Œå› Androidè‡ªå¸¦Skia, æ‰€ä»¥æ‰“åŒ…Androidä¸åŒ…å«Skia, è¿™ä¹Ÿæ˜¯IOSä½“ç§¯è¾ƒå¤§çš„é‡è¦åŸå› ã€‚<br>
<img src="https://wx4.sinaimg.cn/mw690/006292TQly1g48yigwv61j30yu0iyq7m.jpg" alt=""></p>
<h3 id="æ¸²æŸ“æµç¨‹">æ¸²æŸ“æµç¨‹</h3>
<p><img src="https://upload-images.jianshu.io/upload_images/5639324-4424415ff5f8681f.jpg?imageMogr2/auto-orient/" alt=""></p>
<h3 id="ä¸‰æ£µç¥æ ‘">ä¸‰æ£µç¥æ ‘</h3>
<p><img src="https://upload-images.jianshu.io/upload_images/5639324-611c58af9c948150.jpg" alt=""><br>
æ‰€æœ‰æ•…äº‹ï¼Œä»è¿™ä¸ªä¸‰æ£µæ ‘å¼€å§‹...<br>
è¿™ä¸‰é¢—ğŸŒ²åˆ†åˆ«æ˜¯ Widget Tree, Element Tree, RenderObject Tree.</p>
<h4 id="ç¬¬ä¸€é¢—widget">ç¬¬ä¸€é¢—WidgetğŸŒ²</h4>
<pre><code class="language-dart">/// Describes the configuration for an [Element].
abstract class Widget extends DiagnosticableTree {
  /// Initializes [key] for subclasses.
  const Widget({ this.key });
  final Key key;
  
  @protected
  Element createElement();

  /// A short, textual description of this widget.
  @override
  String toStringShort() {
    return key == null ? '$runtimeType' : '$runtimeType-$key';
  }

  @override
  void debugFillProperties(DiagnosticPropertiesBuilder properties) {
    super.debugFillProperties(properties);
    properties.defaultDiagnosticsTreeStyle = DiagnosticsTreeStyle.dense;
  }

  /// Whether the `newWidget` can be used to update an [Element] that currently
  static bool canUpdate(Widget oldWidget, Widget newWidget) {
    return oldWidget.runtimeType == newWidget.runtimeType
        &amp;&amp; oldWidget.key == newWidget.key;
  }
}
</code></pre>
<p>Widgetæºç æ³¨é‡Š <code>Describes the configuration for an [Element].</code><br>
Widgetä½œç”¨å°±æ˜¯ä¸ºElementæè¿°éœ€è¦çš„é…ç½®ï¼Œ è´Ÿè´£åˆ›å»ºElement -&gt; <code>createElement()</code>, ä»¥åŠå†³å®šElementæ˜¯å¦éœ€è¦æ›´æ–° -&gt; <code>canUpdate(Widget oldWidget, Widget newWidget)</code>.<br>
Flutter Frameworké€šè¿‡diffç®—æ³•æ¯”å¯¹Widgetæ ‘å˜åŒ–ï¼Œç„¶åå†³å®šElementçš„Stateæ”¹å˜ã€‚Rebuildåçš„Widgetæ ‘ï¼Œå¦‚æœå¯¹æ¯”æœªå‘ç”Ÿæ”¹å˜ï¼Œ åˆ™Elementä¸ä¼šè§¦å‘é‡ç»˜ï¼Œè¿™å°±æ„å‘³ç€Widgetæ ‘çš„é‡å»ºå¹¶ä¸ä¼šç›´æ¥å¯¼è‡´Elementæ ‘é‡å»ºã€‚</p>
<h4 id="ç¬¬äºŒé¢—element">ç¬¬äºŒé¢—ElementğŸŒ²</h4>
<pre><code class="language-dart">/// An instantiation of a [Widget] at a particular location in the tree.
abstract class Element extends DiagnosticableTree implements BuildContext {
...
  /// The configuration for this element.
  @override
  Widget get widget =&gt; _widget;
  Widget _widget;
  
  /// The render object at (or below) this location in the tree.
  RenderObject get renderObject {
    ...
  }
...
}
</code></pre>
<p>Elementæºç æ³¨é‡Šï¼š <code>An instantiation of a [Widget] at a particular location in the tree.</code><br>
Elementè¡¨ç¤ºWidgeté…ç½®æ ‘ç‰¹å®šä½ç½®çš„ä¸€ä¸ªå®ä¾‹ã€‚æŒæœ‰Widgetå’ŒRenderObject,è´Ÿè´£ç»„ç»‡ç®¡ç†Widgeté…ç½®å’ŒRenderObjectæ¸²æŸ“ã€‚<br>
å¯ä»¥ç†è§£ä¸ºAndroidå’ŒIOSçš„Viewæ ‘ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ElementçŠ¶æ€ä¸€èˆ¬ç”±Flutter Frameworkç®¡ç†ï¼Œ å¼€å‘è€…åªéœ€è´Ÿè´£æ›´æ”¹Widgetå³å¯ã€‚</p>
<h4 id="ç¬¬ä¸‰é¢—renderobject">ç¬¬ä¸‰é¢—RenderObjectğŸŒ²</h4>
<pre><code class="language-dart">/// An object in the render tree.
abstract class RenderObject extends AbstractNode with DiagnosticableTreeMixin implements HitTestTarget {
  ...
  @protected
  void performResize();

  @protected
  void performLayout();

  void paint(PaintingContext context, Offset offset);
  ...
</code></pre>
<p>RenderObjectæºç æ³¨é‡Šï¼š  <code>An object in the render tree.</code><br>
RenderObjectè¡¨ç¤ºä¸ºæ¸²æŸ“æ ‘çš„ä¸€ä¸ªå¯¹è±¡<br>
é¡¾åæ€ä¹‰ï¼ŒRenderObjectè´Ÿè´£çœŸæ­£çš„æ¸²æŸ“å·¥ä½œï¼Œéœ€è¦è‡ªå·±å®šä¹‰ç»˜åˆ¶çš„è¯å°±è¦ä»æ­¤å¤„åˆ‡å…¥, æµ‹é‡å¤§å° <code>performResize</code>ï¼Œå®šä½ä½ç½® <code>performLayout</code>ï¼Œ ç»˜åˆ¶ <code>paint</code>éƒ½ç”±RenderObjectå®Œæˆã€‚</p>
<h4 id="æ€»ç»“">æ€»ç»“</h4>
<p>Widgetä¸ºé…ç½®æ ‘ï¼Œ Elementä¸ºUIæ§åˆ¶æ ‘ï¼ŒRenderObjectä¸ºç»˜åˆ¶æ ‘ã€‚å¼€å‘è€…ç»„åˆWidgeté…ç½®ï¼ŒFrameworké€šè¿‡æ¯”å¯¹Widgeté…ç½®æ¥åˆ›æ–°æˆ–æ›´æ–°Elementï¼Œæœ€åè°ƒåº¦RenderObjectæ¸²æŸ“æ ‘è¿›è¡Œä¸Šå±ç»˜åˆ¶ã€‚</p>
<h2 id="widget-ç§ç±»">Widget ç§ç±»</h2>
<p>Widgetæœ¬èº«é€šå¸¸ç”±è®¸å¤šæ›´å°çš„ã€å•ä¸€ç”¨é€”widgetç»„æˆï¼Œè¿™äº›widgetç»“åˆèµ·æ¥äº§ç”Ÿå¼ºå¤§çš„æ•ˆæœã€‚ä¾‹å¦‚ï¼ŒContaineræ˜¯ä¸€ä¸ªå¸¸ç”¨çš„Widgetï¼Œ ç”±å¤šä¸ªWidgetç»„æˆï¼Œè¿™äº›widgetè´Ÿè´£å¸ƒå±€ã€ç»˜åˆ¶ã€å®šä½å’Œè°ƒæ•´å¤§å°ã€‚å…·ä½“æ¥è¯´ï¼ŒContainerç”± LimitedBoxã€ ConstrainedBoxã€ Alignã€ Paddingã€ DecoratedBoxã€ å’ŒTransformç»„æˆã€‚ æ‚¨å¯ä»¥ç”¨å„ç§æ–¹å¼ç»„åˆè¿™äº›ä»¥åŠå…¶ä»–ç®€å•çš„Widgetï¼Œè€Œä¸æ˜¯ç»§æ‰¿å®¹å™¨ã€‚</p>
<p>ç±»å±‚æ¬¡ç»“æ„å¾ˆæµ…ä¸”å¾ˆå®½ï¼Œå¯ä»¥æœ€å¤§é™åº¦åœ°å¢åŠ å¯èƒ½çš„ç»„åˆæ•°é‡ã€‚<br>
<img src="https://wx1.sinaimg.cn/mw690/006292TQly1g48yigwyf5j315u0nwq58.jpg" alt=""></p>
<h3 id="stateless-widget">Stateless Widget</h3>
<p>æ— çŠ¶æ€Widget, ä½¿ç”¨äºä¸éœ€è¦ç»´æŠ¤çŠ¶æ€çš„åœºæ™¯ï¼Œå³åˆ›å»ºåä¸å¯ä¿®æ”¹é…ç½®æ•°æ®ã€‚</p>
<pre><code class="language-dart">abstract class StatelessWidget extends Widget {
  const StatelessWidget({ Key key }) : super(key: key);

  @override
  StatelessElement createElement() =&gt; StatelessElement(this);
  
  @protected
  Widget build(BuildContext context);
}
</code></pre>
<p>å¯¹åº”StatelessElementï¼Œ å…¶ä¸­BuildContextå³ä¸ºå¯¹åº”çš„Elementå®ä¾‹ã€‚</p>
<h3 id="statefulwidget">StatefulWidget</h3>
<p><img src="https://wx1.sinaimg.cn/mw690/006292TQly1g48yigw7ebj30zk0i4abe.jpg" alt="-w640"></p>
<p>æœ‰çŠ¶æ€widget, é€šè¿‡setState(), å¯ä»¥è§¦å‘rebuild Widget, ä»è€Œåˆ·æ–°ç•Œé¢ã€‚<br>
é€‚ç”¨äºæ•°æ®æ”¹å˜éœ€è¦åˆ·æ–°ç•Œé¢çš„åœºæ™¯ã€‚</p>
<pre><code class="language-dart">abstract class StatefulWidget extends Widget {
  const StatefulWidget({ Key key }) : super(key: key);

  @override
  StatefulElement createElement() =&gt; new StatefulElement(this);

  @protected
  State createState();
}

class StatefulElement extends ComponentElement {
  StatefulElement(StatefulWidget widget)
      : _state = widget.createState(),
        super(widget) {
       }());
    assert(_state._element == null);
    _state._element = this;
    assert(_state._widget == null);
    _state._widget = widget;
    assert(_state._debugLifecycleState == _StateLifecycle.created);
  }
}

</code></pre>
<p>å¯¹åº”StatefulElementï¼Œ Stateåœ¨StatefulElementåˆå§‹åŒ–æ—¶åˆ›å»ºï¼Œ Stateå’ŒStatefulElementç›¸äº’æŒæœ‰ï¼Œæ„å‘³ç€Stateä¸ä¼šéšç€StatefulWidgeté‡å»º, StateæŒæœ‰StatefulWidget.</p>
<pre><code class="language-dart">class _PageWidgetState extends State&lt;_PageWidget&gt; {
  final GlobalKey&lt;RefreshIndicatorState&gt; _refreshIndicatorKey =
      GlobalKey&lt;RefreshIndicatorState&gt;();

  @override
  void initState() {
    super.initState();
    _refreshData();
  }

  Future _refreshData() async {
    Response response = await widget.page._request();
    setState(() {});
    return response;
  }

  @override
  Widget build(BuildContext context) {
    return RefreshIndicator(
      key: _refreshIndicatorKey,
      onRefresh: _refreshData,
    
      ...
    );
  }
</code></pre>
<p>Stateé€šè¿‡setState(), è§¦å‘Rebuild.</p>
<h2 id="ä¾èµ–ç®¡ç†">ä¾èµ–ç®¡ç†</h2>
<p>ä½¿ç”¨pubspec.yamlç®¡ç†ä¾èµ–ï¼Œç±»ä¼¼äºAndroid Gradle, IOS Cocoapods.<br>
<strong>eg:</strong></p>
<pre><code>name: flutter_in_action
description: First Flutter application.

version: 1.0.0+1

dependencies:
  flutter:
    sdk: flutter
  cupertino_icons: ^0.1.2

dev_dependencies:
  flutter_test:
    sdk: flutter

flutter:
  uses-material-design: true
</code></pre>
<h2 id="èµ„æºç®¡ç†">èµ„æºç®¡ç†</h2>
<p>Flutteråº”ç”¨ç¨‹åºå¯ä»¥åŒ…å«ä»£ç å’Œ assetsï¼ˆæœ‰æ—¶ç§°ä¸ºèµ„æºï¼‰ã€‚assetsæ˜¯ä¼šæ‰“åŒ…åˆ°ç¨‹åºå®‰è£…åŒ…ä¸­çš„ï¼Œå¯åœ¨è¿è¡Œæ—¶è®¿é—®ã€‚å¸¸è§ç±»å‹çš„assetsåŒ…æ‹¬é™æ€æ•°æ®ï¼ˆä¾‹å¦‚JSONæ–‡ä»¶ï¼‰ã€é…ç½®æ–‡ä»¶ã€å›¾æ ‡å’Œå›¾ç‰‡ï¼ˆJPEGï¼ŒWebPï¼ŒGIFï¼ŒåŠ¨ç”»WebP / GIFï¼ŒPNGï¼ŒBMPå’ŒWBMPï¼‰ç­‰ã€‚<br>
Flutterä¹Ÿä½¿ç”¨pubspec.yamlæ–‡ä»¶æ¥ç®¡ç†åº”ç”¨ç¨‹åºæ‰€éœ€çš„èµ„æº</p>
<pre><code>  flutter:
  assets:
    - assets/my_icon.png
    - assets/background.png
</code></pre>
<h2 id="å¼€å‘å·¥å…·">å¼€å‘å·¥å…·</h2>
<p>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨<br>
ç¯å¢ƒé…ç½®ç•¥è¿‡...</p>
<h3 id="ideæ’ä»¶">IDEæ’ä»¶</h3>
<p>Flutteræä¾›Android Studioå’ŒVS Codeæ’ä»¶ï¼Œè¿™é‡Œåªçœ‹Android Studio. éœ€ä¸‹è½½flutterå’Œdartæ’ä»¶, å®‰è£…åå¦‚å›¾<br>
<img src="https://wx2.sinaimg.cn/mw1024/006292TQly1g48yih40xgj30u00ym1kx.jpg" alt="-w1148"></p>
<h3 id="codeæ‰“å¼€">Codeæ‰“å¼€</h3>
<p>è¿˜æœ‰ä¸€äº›å·¥å…·éœ€è¦é€šè¿‡ä»£ç æ‰“å¼€ã€‚</p>
<pre><code class="language-dart">void main() {
    debugPaintSizeEnabled = true; // æ˜¾ç¤ºæ–‡å­—åŸºå‡†çº¿
    debugPaintPointersEnabled = true; // çªå‡ºç‚¹å‡»å¯¹è±¡
    debugPaintLayerBordersEnabled = true; // æ˜¾ç¤ºå±‚çº§è¾¹ç•Œ
    debugRepaintRainbowEnabled = true; // æ˜¾ç¤ºé‡ç»˜
    runApp(MyApp());
}
</code></pre>
<h3 id="ä¸€äº›æœ‰æ„æ€çš„å·¥å…·">ä¸€äº›æœ‰æ„æ€çš„å·¥å…·</h3>
<h4 id="select-widget-mode">Select Widget Mode</h4>
<p>æ»‘åŠ¨æ—¶æ˜¾ç¤ºè§¦æ‘¸åŒºåŸŸå¯¹åº”çš„Widgetç±»å‹ã€‚</p>
<p><img src="https://wx2.sinaimg.cn/mw690/006292TQly1g491cv5nf9g30a80fl7wl.gif" alt=""></p>
<h4 id="refresh-widget-info">Refresh Widget Info</h4>
<p>åˆ·æ–° rebuild widgetã€‚</p>
<h4 id="show-performance-overlay">Show Performance Overlay</h4>
<p>æ˜¾ç¤ºæ¯å¸§GPUç»˜åˆ¶æ—¶é—´ï¼Œå’ŒUIç»˜åˆ¶æ—¶é—´ï¼Œåˆ†åˆ«æ˜¾ç¤ºå•å¸§æœ€å¤§ç»˜åˆ¶æ—¶é—´å’Œå¹³å‡ç»˜åˆ¶æ—¶é—´ï¼Œdebugæ¨¡å¼JITè¾¹è§£é‡Šè¾¹æ‰§è¡Œå¯¼è‡´UIä¸èƒ½è·‘æ…¢60å¸§æ¯ç§’ã€‚</p>
<p><img src="https://wx2.sinaimg.cn/mw690/006292TQly1g491nqk44og30ah0ilqv8.gif" alt=""></p>
<h4 id="toggle-platform">Toggle Platform</h4>
<p>åˆ‡æ¢Androidå’ŒIOSå¹³å°, æ³¨æ„ä¸åªæ˜¯TitleBaræ˜¾ç¤ºæ•ˆæœä¸åŒï¼Œè½¬åœºåŠ¨ç”»ä¹Ÿä¸ç›¸åŒã€‚</p>
<p><img src="https://wx1.sinaimg.cn/mw690/006292TQly1g4920glkqhg309r0hbe84.gif" alt=""></p>
<p><img src="https://wx3.sinaimg.cn/mw690/006292TQly1g4920i5z51g30a40hykjo.gif" alt=""></p>
<h4 id="show-debug-paint">Show Debug Paint</h4>
<p>æ˜¾ç¤ºViewè¾¹æ¡†</p>
<p><img src="https://wx1.sinaimg.cn/mw690/006292TQly1g492agwkb1j30am0ixqbm.jpg" alt=""></p>
<h4 id="show-paint-baselines">Show Paint Baselines</h4>
<p>æ˜¾ç¤ºTextåŸºå‡†çº¿</p>
<p><img src="https://wx1.sinaimg.cn/mw690/006292TQly1g492cebm1pj30am0ixagj.jpg" alt=""></p>
<h4 id="debugpaintpointersenabled">debugPaintPointersEnabled</h4>
<p>æ˜¾ç¤ºçªå‡ºå¯¹è±¡</p>
<p><img src="https://wx3.sinaimg.cn/mw690/006292TQly1g492kv7r98j30am0ix43o.jpg" alt=""></p>
<h4 id="debugpaintlayerbordersenabled">debugPaintLayerBordersEnabled</h4>
<p>æ˜¾ç¤ºå±‚çº§è¾¹ç•Œ</p>
<p><img src="https://wx3.sinaimg.cn/mw690/006292TQly1g492n56azoj30am0ixn3a.jpg" alt=""></p>
<h4 id="debugrepaintrainbowenabled">debugRepaintRainbowEnabled</h4>
<p>æ˜¾ç¤ºé‡ç»˜</p>
<p><img src="https://wx2.sinaimg.cn/mw690/006292TQly1g492qil7dwg30a40hy7wj.gif" alt=""></p>
<h2 id="å¼€æºåº“æ”¯æŒ">å¼€æºåº“æ”¯æŒ</h2>
<p><a href="https://pub.dev/flutter">https://pub.dev/flutter</a><br>
<img src="https://wx1.sinaimg.cn/mw690/006292TQly1g4c115fuhaj30u01144ky.jpg" alt=""><br>
Flutterå·²æœ‰å¾ˆå¤šé«˜è´¨é‡çš„å¼€æºåº“ï¼Œæ¶µç›–å¸¸ç”¨çš„ç½‘ç»œè¯·æ±‚ï¼Œæ•°æ®åº“ï¼Œå›¾ç‰‡å¤„ç†ï¼Œå›¾ç‰‡é€‰æ‹©å™¨ï¼Œåœ°å›¾ï¼Œæ”¯ä»˜ï¼ŒWebView ï¼Œè·¯ç”±ï¼Œshared_preferencesç­‰ç­‰ã€‚å„å¤§å‚ä¹Ÿåœ¨ç§¯æçš„æ¨è¿›Flutter, ç›¸ä¿¡æœªæ¥Flutterå¼€å‘ä¼šæ›´ç®€å•å’Œå¿«é€Ÿã€‚</p>
<h2 id="æ€»ç»“-2">æ€»ç»“</h2>
<pre><code>Makes it easy and fast to build beautiful mobile apps
for iOS and Android.
</code></pre>
<p>Fultterå¼€å‘å¾ˆåƒæ˜¯ç§¯æœ¨æ¸¸æˆï¼ŒåŠŸèƒ½ä¸°å¯Œçš„ç»„ä»¶ï¼Œèƒ½è®©ä½ ç®€å•å¿«é€Ÿçš„æ­å»ºæ¼‚äº®ä¸”é«˜æ€§èƒ½çš„Appã€‚ç°åœ¨å„å¤§å‚éƒ½æœ‰Flutterå°è¯•ï¼Œé—²é±¼å·²ç»åœ¨ç”Ÿäº§ç¯å¢ƒç©å¾ˆä¹…ï¼Œåä¸ºçš„é¸¿è’™ç³»ç»Ÿæ›´æ˜¯ç›´æ¥é›†æˆäº†Flutterç¯å¢ƒï¼Œç‡åŸä¹‹åŠ¿å·²èµ·ã€‚</p>
<p>åç»­Flutterå¦‚æœèƒ½é¡ºåˆ©æ¨è¿›Web, MacOS, Linux, Windowæ”¯æŒï¼Œç›¸ä¿¡ä¸€é—¨è¯­è¨€èµ°å¤©ä¸‹çš„é‚£ä¸€å¤©å°±è¦æ¥äº†...</p>
<h2 id="demo-æ–°é—»å®¢æˆ·ç«¯">DEMO æ–°é—»å®¢æˆ·ç«¯</h2>
<p><a href="https://github.com/songhanghang/flutter_news_demo"><strong>https://github.com/songhanghang/flutter_news_demo</strong></a></p>
<p><img src="https://wx2.sinaimg.cn/mw690/006292TQly1g3v1ygaisdg30dc0np1l0.gif" alt="gif"></p>
<p>æºç ï¼š</p>
<pre><code class="language-dart">import 'dart:async';
import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:flutter/rendering.dart';
import 'package:dio/dio.dart';
import 'package:flutter_webview_plugin/flutter_webview_plugin.dart';

Dio dio = Dio();

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: ScrollableTabsDemo(),
    );
  }
}

class _Page {
  _Page({this.text, this.key})
      : this.url = &quot;https://3g.163.com/touch/reconstruct/article/list/$key/0-20.html&quot;;
  final String text;
  final String key;
  final String url;
  final List&lt;_News&gt; list = List();

  Future _request() async {
    Response response = await dio.get(url);
    String value = response.toString();
    value = value.substring(9, value.length - 1);
    Map&lt;String, dynamic&gt; map = json.decode(value);
    List data = map[key];
    list.clear();
    data.forEach((value) {
      list.add(_News.fromJson(value));
    });
    return response;
  }
}

class _News {
  final String title;
  final String url;
  final String skpUrl;
  final String image;
  final String digest;
  final String time;

  _News.fromJson(Map&lt;String, dynamic&gt; json)
      : title = json[&quot;title&quot;],
        url = json[&quot;url&quot;],
        skpUrl = json[&quot;skipURL&quot;],
        image = json[&quot;imgsrc&quot;],
        digest = json[&quot;digest&quot;],
        time = json[&quot;ptime&quot;];
}

List&lt;_Page&gt; _allPages = &lt;_Page&gt;[
  _Page(text: 'æ–°é—»', key: &quot;BBM54PGAwangning&quot;),
  _Page(text: 'å¨±ä¹', key: &quot;BA10TA81wangning&quot;),
  _Page(text: 'ä½“è‚²', key: &quot;BA8E6OEOwangning&quot;),
  _Page(text: 'è´¢ç»', key: &quot;BA8EE5GMwangning&quot;),
  _Page(text: 'å†›äº‹', key: &quot;BAI67OGGwangning&quot;),
  _Page(text: 'ç§‘æŠ€', key: &quot;BA8D4A3Rwangning&quot;),
  _Page(text: 'æ‰‹æœº', key: &quot;BAI6I0O5wangning&quot;),
  _Page(text: 'æ•°ç ', key: &quot;BAI6JOD9wangning&quot;),
  _Page(text: 'æ—¶å°š', key: &quot;BA8F6ICNwangning&quot;),
  _Page(text: 'æ¸¸æˆ', key: &quot;BAI6RHDKwangning&quot;),
  _Page(text: 'æ•™è‚²', key: &quot;BA8FF5PRwangning&quot;),
  _Page(text: 'å¥åº·', key: &quot;BDC4QSV3wangning&quot;),
  _Page(text: 'æ—…æ¸¸', key: &quot;BEO4GINLwangning&quot;),
];

class ScrollableTabsDemo extends StatefulWidget {
  @override
  _ScrollableTabsState createState() =&gt; _ScrollableTabsState();
}

class _ScrollableTabsState extends State&lt;ScrollableTabsDemo&gt;
    with SingleTickerProviderStateMixin {
  TabController _controller;

  @override
  void initState() {
    super.initState();
    _controller = TabController(vsync: this, length: _allPages.length);
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }

  Decoration _getIndicator() {
    return ShapeDecoration(
      shape: const RoundedRectangleBorder(
            borderRadius: BorderRadius.all(Radius.circular(8.0)),
            side: BorderSide(color: Colors.white70, width: 1.5),
          ) +
          const RoundedRectangleBorder(
            borderRadius: BorderRadius.all(Radius.circular(4.0)),
            side: BorderSide(color: Colors.transparent, width: 8.0),
          ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: NestedScrollView(
        headerSliverBuilder: (BuildContext context, bool innerBoxIsScrolled) {
          return &lt;Widget&gt;[
            SliverOverlapAbsorber(
              handle: NestedScrollView.sliverOverlapAbsorberHandleFor(context),
              child: SliverAppBar(
                title: const Text('News'),
                pinned: false,
                backgroundColor: Colors.red,
                forceElevated: innerBoxIsScrolled,
                bottom: TabBar(
                  controller: _controller,
                  isScrollable: true,
                  labelColor: Colors.white,
                  indicator: _getIndicator(),
                  tabs: _allPages.map&lt;Tab&gt;((_Page page) {
                    return Tab(text: page.text);
                  }).toList(),
                ),
              ),
            ),
          ];
        },
        body: TabBarView(
          controller: _controller,
          children: _allPages.map&lt;Widget&gt;((_Page page) {
            return SafeArea(
              top: false,
              bottom: true,
              child: _PageWidget(page),
            );
          }).toList(),
        ),
      ),
    );
  }
}

class _PageWidget extends StatefulWidget {
  const _PageWidget(this.page, {Key key}) : super(key: key);
  final _Page page;

  @override
  State&lt;StatefulWidget&gt; createState() {
    return _PageWidgetState();
  }
}

class _PageWidgetState extends State&lt;_PageWidget&gt; {
  final GlobalKey&lt;RefreshIndicatorState&gt; _refreshIndicatorKey =
      GlobalKey&lt;RefreshIndicatorState&gt;();

  @override
  void initState() {
    super.initState();
    _refreshData();
  }

  Future _refreshData() async {
    Response response = await widget.page._request();
    setState(() {});
    return response;
  }

  @override
  Widget build(BuildContext context) {
    return RefreshIndicator(
      key: _refreshIndicatorKey,
      onRefresh: _refreshData,
      child: Scrollbar(
        child: ListView.builder(
          padding: kMaterialListPadding,
          itemCount: widget.page.list.length,
          itemBuilder: (BuildContext context, int index) {
            return GestureDetector(
              onTap: () {
                Navigator.push(context, MaterialPageRoute(builder: (context) {
                  String url = widget.page.list[index].url;
                  if (!url.startsWith(&quot;http&quot;)) {
                    url = widget.page.list[index].skpUrl;
                  }
                  return WebviewScaffold(
                      appBar: AppBar(title: Text(&quot;è¯¦æƒ…&quot;), backgroundColor: Colors.red),
                      url: url);
                }));
              },
              child: Padding(
                  padding: EdgeInsets.all(8.0),
                  child: Row(
                    children: &lt;Widget&gt;[
                      DecoratedBox(
                        decoration: BoxDecoration(
                            borderRadius: BorderRadius.circular(3.0),
                            boxShadow: [
                              BoxShadow(
                                  color: Colors.black54,
                                  offset: Offset(2.0, 2.0),
                                  blurRadius: 4.0)
                            ]),
                        child: Image.network(
                          widget.page.list[index].image,
                          width: 140,
                          height: 80,
                          fit: BoxFit.cover,
                        ),
                      ),
                      Expanded(
                          flex: 1,
                          child: Padding(
                              padding: EdgeInsets.only(left: 10),
                              child: Align(
                                  alignment: Alignment.centerLeft,
                                  child: Wrap(
                                    children: &lt;Widget&gt;[
                                      Text(widget.page.list[index].title),
                                      Text(
                                        widget.page.list[index].digest,
                                        style: TextStyle(
                                            color: Colors.black87,
                                            fontSize: 10.0),
                                      ),
                                      Text(
                                        widget.page.list[index].time,
                                        style: TextStyle(
                                            color: Colors.black54,
                                            fontSize: 8.0),
                                      )
                                    ],
                                  ))))
                    ],
                  )),
            );
          },
        ),
      ),
    );
  }
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redcord è¿æ¥ä½ æˆ‘]]></title>
        <id>https://songhanghang.github.io/post/redcord-lian-jie-ni-wo</id>
        <link href="https://songhanghang.github.io/post/redcord-lian-jie-ni-wo">
        </link>
        <updated>2019-06-06T11:59:33.000Z</updated>
        <summary type="html"><![CDATA[<meta name="referrer" content="no-referrer" />
éå¸¸æŠ±æ­‰ï¼Œå› è¿‘æœŸæ”¿ç­–åŸå› ï¼Œå‚¨å­˜æœåŠ¡å¿…é¡»å¤‡æ¡ˆï¼Œè´¹ç”¨ä¸ä½ï¼Œæ‰€ä»¥10æœˆ1å·èµ·æœ‰å¯èƒ½éšæ—¶åœæœ...
<p>åœ¨æ­¤ç¥å„ä½å¹¸ç¦å“¦ï¼</p>
<p>æ˜¯å¦é‡åˆ°è¿‡ï¼Œæœ‰æ€¥äº‹æ‰¾Ta, ä½†æ˜¯ç”µè¯æ‰“ä¸é€šï¼Œå¾®ä¿¡æ²¡äººæ¥ï¼Œå³ä½¿ç§‘æŠ€å†å‘è¾¾ï¼Œæ‰¾Taæ—¶ä½ ä¹ŸæŠ“çï¼</p>
]]></summary>
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" />
éå¸¸æŠ±æ­‰ï¼Œå› è¿‘æœŸæ”¿ç­–åŸå› ï¼Œå‚¨å­˜æœåŠ¡å¿…é¡»å¤‡æ¡ˆï¼Œè´¹ç”¨ä¸ä½ï¼Œæ‰€ä»¥10æœˆ1å·èµ·æœ‰å¯èƒ½éšæ—¶åœæœ...
<p>åœ¨æ­¤ç¥å„ä½å¹¸ç¦å“¦ï¼</p>
<p>æ˜¯å¦é‡åˆ°è¿‡ï¼Œæœ‰æ€¥äº‹æ‰¾Ta, ä½†æ˜¯ç”µè¯æ‰“ä¸é€šï¼Œå¾®ä¿¡æ²¡äººæ¥ï¼Œå³ä½¿ç§‘æŠ€å†å‘è¾¾ï¼Œæ‰¾Taæ—¶ä½ ä¹ŸæŠ“çï¼</p>
<!-- more -->
<blockquote>
<p>çº¢ç»³-è¿æ¥ä½ æˆ‘<br>
<a href="https://github.com/songhanghang/redcord">https://github.com/songhanghang/redcord</a></p>
</blockquote>
<p>å¦‚æœä½ å’Œå®¶äººéƒ½æ˜¯iphoneç”¨æˆ·ï¼Œå¯ä»¥å¼€å¯<a href="https://support.apple.com/zh-cn/HT201087">å®¶äººä½ç½®å…±äº«</a>ï¼Œè¿™æ ·å¯ä»¥éšæ—¶éšåœ°æŸ¥çœ‹Taåœ¨ä»€ä¹ˆä½ç½®ã€‚</p>
<p>Androidç°åœ¨å¹¶æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå¼ºå¤§å¦‚å¾®ä¿¡ä¹Ÿå¿…é¡»æ‰‹åŠ¨å¼€å¯ä½ç½®å…±äº«ï¼Œå½“ç„¶å¾®ä¿¡ä¸åšæ˜¯æœ‰ä»–çš„é“ç†...</p>
<p>ä½†æ˜¯æˆ‘ç¡®å®æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘çš„TAåªè¦ä¸€å‡ºé—¨ï¼Œé‚£æ˜¯æ°¸è¿œè”ç³»ä¸ä¸Šçš„, å—¯ï¼ç¡®å®æœ‰å¿…è¦&quot;å·å·&quot;ç»™å¥¹å®šä½ï¼äºæ˜¯ä¹ï¼Œæ‰‹æ’•äº†è¿™ä¸ªç¨‹åº...</p>
<p>å…ˆæ¢³ç†ä¸‹æœ‰å“ªäº›éœ€æ±‚ï¼š</p>
<ol>
<li>éœ€è¦å®šä½</li>
<li>éœ€è¦æŠŠå®šä½ä¿¡æ¯åŒæ­¥ç»™æˆ‘</li>
<li>éœ€è¦ç¨‹åºä¸€ç›´æ´»ç€</li>
</ol>
<p>å®šä½é—®é¢˜é«˜å¾·åœ°å›¾SDKè§£å†³ï¼ŒåŒæ­¥é—®é¢˜leancloudè§£å†³ï¼Œæ€ä¹ˆæ‰èƒ½ä¸€ç›´æ´»ç€ï¼Œè¿™æ˜¯ä¸ªå¤´ç–¼çš„é—®é¢˜ï¼Œå¾®ä¿¡å¯ä»¥è¢«å„å¤§æ‰‹æœºå‚å•†ç™½åå•å‘µæŠ¤ç€, ä½†æ˜¯ä¸€èˆ¬Appä¸å¯èƒ½æœ‰è¿™ä¸ªå¾…é‡ã€‚</p>
<p>ä¸šå†…èƒ½äººå¿—å£«ä¸ºäº†ä¿æ´»ä½¿å‡ºå„ç§å¥‡æ·«æŠ€å·§ï¼Œä¾‹å¦‚ï¼š</p>
<ol>
<li>åŒè¿›ç¨‹äº’è°ƒ</li>
<li>å¯è§å‰å°è¿›ç¨‹</li>
<li>ä¸€ä¸ªå¯è§åƒç´ ç‚¹Activity</li>
<li>åº”ç”¨è”ç›Ÿ(æµæ°“è”ç›Ÿ)ï¼Œé€šè¿‡ä¸åŒçš„Appå‘å¹¿æ’­äº’è°ƒ</li>
<li>åˆ©ç”¨Androidç³»ç»Ÿæ¼æ´<br>
æ€»ä¹‹é»‘ç™½æ‰‹æ®µéƒ½æœ‰ï¼Œä½†æ˜¯æ´»çš„éƒ½ä¸å…‰å½©ï¼Œç¨‹åºè¿˜æ˜¯è¦æ¼‚äº®çš„æ´»ç€ï¼</li>
</ol>
<p>äºæ˜¯ä¹æƒ³åˆ°äº†Androidçš„åŠ¨æ€å£çº¸ï¼Œè¿™ç©æ„å¥½ï¼Œå£çº¸æ˜¯è„¸é¢ï¼Œç³»ç»Ÿè¦è„¸ï¼Œå°±ä¸èƒ½è®©å®ƒæ­»ï¼Œæ­»äº†ä¹Ÿè¦ä¸»åŠ¨æ‹‰èµ·æ¥!</p>
<p>é‚£ä¹ˆåšä¸ªå¥½çœ‹çš„åŠ¨æ€å£çº¸ï¼Œé€šè¿‡å£çº¸å®šä½å’ŒåŒæ­¥ä¿¡æ¯å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜.</p>
<p>Coding....</p>
<p>emmmmm....</p>
<p><img src="https://wx1.sinaimg.cn/mw690/006292TQly1g25r4ipgbkg30bd0om4qr.gif" alt="å›¾ç‰‡"></p>
<h3 id="ä¸‹è½½">ä¸‹è½½</h3>
<p><img src="https://wx4.sinaimg.cn/mw690/006292TQly1g3ac6bxnz9j30440440b9.jpg" alt="å›¾ç‰‡"></p>
<p><a href="https://www.coolapk.com/apk/com.song.redcord">https://www.coolapk.com/apk/com.song.redcord</a></p>
<h3 id="è½¯ä»¶åŠŸèƒ½ä»‹ç»">è½¯ä»¶åŠŸèƒ½ä»‹ç»</h3>
<h4 id="æ³¨å†Œä¸ç™»å½•">æ³¨å†Œä¸ç™»å½•</h4>
<p>æ³¨å†Œä¸éœ€è¦æ‰‹æœºå·,ä¸éœ€è¦é‚®ç®±ï¼ˆä¸ä¼šä¸Šä¼ ä½ çš„éšç§ï¼‰ï¼Œç›´æ¥ç‚¹å‡»æ³¨å†Œå³å¯ï¼Œæ³¨å†ŒæˆåŠŸåä¼šç”Ÿæˆä½ çš„ID, æ˜¾ç¤ºåœ¨å±å¹•çš„å·¦ä¸Šè§’ï¼Œè¿™æ˜¯ä½ ä»¥åç™»å½•çš„å”¯ä¸€å‡­è¯ï¼ˆæ³¨æ„ä¿å¯†ï¼‰ï¼Œæ³¨å†ŒæˆåŠŸåï¼Œéœ€è¦é…å¯¹TAçš„ID, æ‰èƒ½ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å‘é€è‡ªå·±IDç»™Ta, è®©å¯¹æ–¹å®Œæˆé…å¯¹ã€‚é…å¯¹å®Œæˆè¯·åŠæ—¶åœ¨è¯¦æƒ…é¡µå¤‡ä»½ä¸¤äººIdã€‚<br>
ä½ ä¸Taçš„IDå”¯ä¸€ç»‘å®šï¼Œç»‘å®šåä¸å¯è§£ç»‘ï¼Œæˆ–è€…ä¸ä»–äººç»‘å®šã€‚</p>
<h4 id="ä¸»ç•Œé¢">ä¸»ç•Œé¢</h4>
<p>Appåœ°å›¾ç•Œé¢ï¼Œå·¦ä¸Šè§’æ˜¾ç¤ºä¸¤äººID, ä¸­é—´ä¸ºå½¼æ­¤ä½ç½®åŠé©¾è½¦å¯¼èˆªè·¯çº¿ï¼Œä¿¡æ¯æ¡†æ˜¾ç¤ºTaçš„ä½ç½®ä¿¡æ¯ï¼Œæä¾›ä¸€äº›å¸¸ç”¨åŠŸèƒ½:</p>
<ol>
<li>è§Ta       <code>ä¸€é”®å¯¼èˆªè§Taï¼Œé«˜å¾·ï¼Œç™¾åº¦åœ°å›¾</code></li>
<li>è®¾ç½®å£çº¸</li>
<li>å¤‡ä»½       <code>å¤‡ä»½ä¸¤äººID, ä»¥ä¾¿æ¢æ‰‹æœºï¼Œæˆ–è€…æ¸…ç©ºç¼“å­˜æ‰¾å›</code></li>
<li>æ‰“èµ       <code>ç”¨çš„leancloudçš„æœåŠ¡ï¼Œå…è´¹çš„è®¿é—®é‡å¾ˆå°‘ï¼Œå¾ˆæœŸæœ›æ‚¨çš„æ”¯æŒ</code></li>
<li>å…³äº       <code>æŒ‡å‘è¿™ç¯‡ReadMe</code></li>
</ol>
<h4 id="åŠ¨æ€å£çº¸">åŠ¨æ€å£çº¸</h4>
<p>è¿™æ˜¯ä¸ªé­”æ€§çš„å£çº¸ï¼Œå±å¹•ä¸Šä¸€æ ¹çº¢ç»³åœ¨ä¸åœæ‰­åŠ¨ï¼Œçº¿çš„ä¸¤ç«¯è¿ç€ä¸¤ä¸ªåœ†ï¼Œè±¡å¾ç€å½¼æ­¤ï¼Œä¸­é—´æ˜¾ç¤ºç€å®æ—¶ä½ç½®è·ç¦»ï¼ŒèƒŒæ™¯è‰²éšç€æ‰­åŠ¨æ¸å˜ï¼Œè§¦æ‘¸å±å¹•åŠ¨ç”»éšæ‰‹è€ŒåŠ¨ï¼Œæ—©ä¸Šï¼Œä¸‹åˆï¼Œæ™šä¸Šä¸‰ç»„é¢œè‰²è‡ªåŠ¨åˆ‡æ¢ã€‚</p>
<h4 id="å…¶ä»–">å…¶ä»–</h4>
<ol>
<li>è€—ç”µ   <code>ä¸»ç•Œé¢:10så®šä½ä¸€æ¬¡ï¼Œé€€å‡ºåä¸å†å®šä½;åŠ¨æ€å£çº¸:å¯è§æ—¶30så®šä½ä¸€æ¬¡ï¼Œä¸å¯è§ä¸å®šä½ã€‚æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒè€—ç”µé—®é¢˜</code></li>
<li>ç”¨æˆ·éšç§ <code>æ²¡æœ‰ä¸Šä¼ ä½ ä»»ä½•å…¶ä»–ä¿¡æ¯ï¼Œè‡ªè¡ŒæŸ¥çœ‹ä»£ç </code></li>
<li>æ•°æ®æœåŠ¡ <code>ç”¨çš„leancloudæä¾›æ•°æ®æ”¯æŒï¼Œæ¯å¤©åªæœ‰3ä¸‡æ¬¡å…è´¹è¯·æ±‚ï¼Œæ‰€ä»¥æ€¥éœ€æ‚¨çš„æ”¯æŒ</code></li>
<li>Bug <code>å°ç±³æ‰‹æœºä¸Šå®Œæˆçš„å¼€å‘æµ‹è¯•ï¼Œå…¶ä»–æœºå™¨æœ‰é—®é¢˜ï¼Œæ¬¢è¿åé¦ˆ</code></li>
</ol>
<h3 id="è”ç³»æ–¹å¼">è”ç³»æ–¹å¼</h3>
<p>é‚®ç®±: 1131442853@qq.com</p>
<p><a href="https://github.com/songhanghang">github: https://github.com/songhanghang</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[MakeFileæŒ‡å—]]></title>
        <id>https://songhanghang.github.io/post/makefile-zhi-nan</id>
        <link href="https://songhanghang.github.io/post/makefile-zhi-nan">
        </link>
        <updated>2018-07-01T12:13:27.000Z</updated>
        <summary type="html"><![CDATA[<blockquote>
<p>å‚è€ƒ:<br>
GNU make: <a href="https://www.gnu.org/software/make/manual/make.html">https://www.gnu.org/software/make/manual/make.html</a></p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>å‚è€ƒ:<br>
GNU make: <a href="https://www.gnu.org/software/make/manual/make.html">https://www.gnu.org/software/make/manual/make.html</a></p>
</blockquote>
<!-- more -->
<blockquote>
<p>Android.mk: <a href="https://developer.android.com/ndk/guides/android_mk.html?hl=zh-cn">https://developer.android.com/ndk/guides/android_mk.html?hl=zh-cn</a></p>
<p>é™ˆçš“: <a href="https://seisman.github.io/how-to-write-makefile/">https://seisman.github.io/how-to-write-makefile/</a></p>
<p>å»ºè®®:<br>
æ¨èä½¿ç”¨Sublime Textè¿›è¡Œmakefileå¼€å‘ï¼ŒSublime Textæ”¯æŒmakefileè¯­æ³•é«˜äº®ï¼Œè‡ªåŠ¨ç¼–è¯‘ï¼Œç¼–è¯‘é”™è¯¯æç¤ºï¼Œè™½æ”¯æŒåŠŸèƒ½ç”šå°‘ï¼Œä½†èŠèƒœäºæ— ï¼Œèƒ½è®©ä½ æ„Ÿè§‰è‡ªå·±æ˜¯åœ¨å†™ä»£ç ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¾‘æ–‡æœ¬ğŸ˜’</p>
</blockquote>
<h2 id="makefileä»‹ç»">Makefileä»‹ç»</h2>
<h3 id="èµ·æº">èµ·æº</h3>
<p>æ–¯å›¾äºšç‰¹Â·è´¹å°”å¾·æ›¼åœ¨1977å¹´åœ¨è´å°”å®éªŒå®¤é‡Œåˆ¶ä½œäº†è¿™ä¸ªè½¯ä»¶ã€‚2003å¹´ï¼Œæ–¯å›¾äºšç‰¹Â·è´¹å°”å¾·æ›¼å› å‘æ˜äº†è¿™æ ·ä¸€ä¸ªé‡è¦çš„å·¥å…·è€Œæ¥å—äº†ç¾å›½è®¡ç®—æœºåä¼šï¼ˆACMï¼‰é¢å‘çš„è½¯ä»¶ç³»ç»Ÿå¥–ã€‚<br>
åœ¨makeè¯ç”Ÿä¹‹å‰ï¼Œç¼–è¯‘å·¥ä½œä¸»è¦ä¾èµ–äºæ“ä½œç³»ç»Ÿé‡Œé¢çš„ç±»ä¼¼äºâ€œmakeâ€ã€â€œinstallâ€åŠŸèƒ½çš„shellè„šæœ¬ã€‚å®ƒå¯ä»¥æ‰¹é‡æ‰§è¡Œç”Ÿæˆç›®æ ‡çš„å‘½ä»¤ï¼Œå¹¶ä¸”å¯ä»¥å®Œæˆä¾èµ–å…³ç³»çš„æ£€æŸ¥ã€‚è¿™æ˜¯å‘ç°ä»£ç¼–è¯‘ç¯å¢ƒå‘å±•çš„é‡è¦ä¸€æ­¥ã€‚</p>
<h3 id="æ¦‚è¿°">æ¦‚è¿°</h3>
<blockquote>
<p>ç»´åŸºç™¾ç§‘ï¼š<br>
Most often, the makefile directs make on how to compile and link a program. Using C/C++ as an example, when a C/C++ source file is changed, it must be recompiled. If a header file has changed, each C/C++ source file that includes the header file must be recompiled to be safe. Each compilation produces an object file corresponding to the source file. Finally, if any source file has been recompiled, all the object files, whether newly made or saved from previous compilations, must be linked together to produce the new executable program. These instructions with their dependencies are specified in a makefile. If none of the files that are prerequisites have been changed since the last time the program was compiled, no actions take place. For large software projects, using Makefiles can substantially reduce build times if only a few source files have changed</p>
</blockquote>
<p>é€šå¸¸ï¼ŒmakefileæŒ‡å®šå¦‚ä½•ç¼–è¯‘å’Œé“¾æ¥ç¨‹åºã€‚ä»¥C/C++ä¸ºä¾‹ï¼Œå½“C/C++æºæ–‡ä»¶è¢«æ”¹å˜æ—¶ï¼Œå¿…é¡»é‡æ–°ç¼–è¯‘ã€‚å¦‚æœå¤´æ–‡ä»¶å·²ç»æ”¹å˜ï¼Œé‚£ä¹ˆåŒ…å«å¤´æ–‡ä»¶çš„æ¯ä¸ªC/C++æºæ–‡ä»¶éƒ½å¿…é¡»é‡æ–°ç¼–è¯‘ä»¥ç¡®ä¿å®‰å…¨ã€‚æ¯ä¸ªç¼–è¯‘ç”Ÿæˆä¸€ä¸ªå¯¹åº”äºæºæ–‡ä»¶çš„ç›®æ ‡æ–‡ä»¶ã€‚æœ€åï¼Œå¦‚æœæ‰€æœ‰æºæ–‡ä»¶å·²ç»è¢«é‡æ–°ç¼–è¯‘ï¼Œæ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ— è®ºæ˜¯æ–°å»ºçš„è¿˜æ˜¯ä»ä»¥å‰çš„ç¼–è¯‘ä¸­ä¿å­˜çš„ï¼Œéƒ½å¿…é¡»é“¾æ¥åœ¨ä¸€èµ·ï¼Œä»¥äº§ç”Ÿæ–°çš„å¯æ‰§è¡Œç¨‹åºã€‚è¿™äº›æŒ‡ä»¤åŠå…¶ä¾èµ–å…³ç³»åœ¨makefileä¸­æŒ‡å®šã€‚å¦‚æœè‡ªä¸Šæ¬¡ç¼–è¯‘ç¨‹åºä»¥æ¥æ²¡æœ‰ä»»ä½•å…ˆå†³æ¡ä»¶çš„æ–‡ä»¶å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚å¯¹äºå¤§å‹è½¯ä»¶é¡¹ç›®ï¼Œå¦‚æœåªæœ‰å°‘æ•°æºæ–‡ä»¶å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™ä½¿ç”¨Makefileå¯ä»¥æ˜¾ç€ç¼©çŸ­ç”Ÿæˆæ—¶é—´ã€‚</p>
<h2 id=""></h2>
<h3 id="æ ¸å¿ƒè§„åˆ™">æ ¸å¿ƒè§„åˆ™</h3>
<pre><code class="language-makefile">target ... : prerequisites ...
    command
    ...
    ...
</code></pre>
<p><strong>target</strong><br>
å¯ä»¥æ˜¯ä¸€ä¸ªobject file*ï¼ˆç›®æ ‡æ–‡ä»¶ï¼‰<em>ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ‰§è¡Œæ–‡ä»¶ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ ‡ç­¾</em>ï¼ˆlabelï¼‰*<br>
<strong>prerequisites</strong><br>
ç”Ÿæˆè¯¥targetæ‰€ä¾èµ–çš„æ–‡ä»¶æˆ–target<br>
<strong>command</strong><br>
è¯¥targetè¦æ‰§è¡Œçš„å‘½ä»¤*ï¼ˆä»»æ„çš„shellå‘½ä»¤ï¼‰*</p>
<p>makefileæœ€æ ¸å¿ƒå†…å®¹ï¼š  <em><strong>prerequisitesä¸­å¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æ¯”targetæ–‡ä»¶è¦æ–°çš„è¯ï¼Œcommandæ‰€å®šä¹‰çš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œã€‚</strong></em></p>
<h3 id="å¦‚ä½•å·¥ä½œ">å¦‚ä½•å·¥ä½œ</h3>
<pre><code class="language-Shell"># è‡ªåŠ¨ç¼–è¯‘å½“å‰ç›®å½•ä¸‹åå­—å«â€œMakefileâ€æˆ–â€œmakefileâ€çš„æ–‡ä»¶ï¼ˆä¸å¸¦åç¼€ï¼‰
make
# æˆ–è€…æŒ‡å®šè‡ªå®šä¹‰åå­—makefileæ–‡ä»¶
make -f custom.mk
</code></pre>
<ol>
<li>makeä¼šæŸ¥æ‰¾æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªtargetæ–‡ä»¶ï¼Œå¦‚æœèƒ½å¤Ÿæ‰¾åˆ°å¹¶ä¸”targetæ‰€ä¾èµ–çš„prerequisitesæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸æ¯”targetæ–‡ä»¶æ–°ï¼Œåˆ™å°†å…¶ä½œä¸ºæœ€ç»ˆçš„ç›®æ ‡æ–‡ä»¶ã€‚</li>
<li>å¦åˆ™ï¼Œæ‰§è¡Œåé¢å®šä¹‰çš„commandç”Ÿæˆæ–°çš„targetæ–‡ä»¶ã€‚</li>
<li>å¦‚æœprerequisitesæ–‡ä»¶ä¹Ÿä¸å­˜åœ¨ï¼Œé‚£ä¹ˆmakeä¼šåœ¨å½“å‰makefileä¸­æ‰¾åˆ°prerequisitesä½œä¸ºtargetçš„ä¾èµ–ï¼Œå¦‚æœæ‰¾åˆ°å†æ ¹æ®å…¶è§„åˆ™ç”Ÿæˆè¯¥prerequisitesæ–‡ä»¶ï¼Œä»¥æ­¤é€’å½’ï¼Œç›´è‡³æ‰¾åˆ°é€’å½’å‡ºå£æ”¶æ‹¢ç»“æŸã€‚</li>
</ol>
<h3 id="åŒ…å«å†…å®¹">åŒ…å«å†…å®¹</h3>
<p>Makefileé‡Œä¸»è¦åŒ…å«äº†äº”ä¸ªä¸œè¥¿ï¼šæ˜¾å¼è§„åˆ™ã€éšæ™¦è§„åˆ™ã€å˜é‡å®šä¹‰ã€æ–‡ä»¶æŒ‡ç¤ºå’Œæ³¨é‡Šã€‚</p>
<ol>
<li>æ˜¾å¼è§„åˆ™ã€‚æ˜¾å¼è§„åˆ™è¯´æ˜äº†å¦‚ä½•ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡æ–‡ä»¶ã€‚è¿™æ˜¯ç”±Makefileçš„ä¹¦å†™è€…æ˜æ˜¾æŒ‡å‡ºè¦ç”Ÿæˆçš„ æ–‡ä»¶ã€æ–‡ä»¶çš„ä¾èµ–æ–‡ä»¶å’Œç”Ÿæˆçš„å‘½ä»¤ã€‚</li>
<li>éšæ™¦è§„åˆ™ã€‚ç”±äºæˆ‘ä»¬çš„makeæœ‰è‡ªåŠ¨æ¨å¯¼çš„åŠŸèƒ½ï¼Œæ‰€ä»¥éšæ™¦çš„è§„åˆ™å¯ä»¥è®©æˆ‘ä»¬æ¯”è¾ƒç®€ç•¥åœ°ä¹¦å†™ Makefileï¼Œè¿™æ˜¯ç”±makeæ‰€æ”¯æŒçš„ã€‚</li>
<li>å˜é‡çš„å®šä¹‰ã€‚åœ¨Makefileä¸­æˆ‘ä»¬è¦å®šä¹‰ä¸€ç³»åˆ—çš„å˜é‡ï¼Œå˜é‡ä¸€èˆ¬éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæœ‰ç‚¹åƒä½ Cè¯­è¨€ä¸­çš„å®ï¼Œå½“Makefileè¢«æ‰§è¡Œæ—¶ï¼Œå…¶ä¸­çš„å˜é‡éƒ½ä¼šè¢«æ‰©å±•åˆ°ç›¸åº”çš„å¼•ç”¨ä½ç½®ä¸Šã€‚</li>
<li>æ–‡ä»¶æŒ‡ç¤ºã€‚å…¶åŒ…æ‹¬äº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨ä¸€ä¸ªMakefileä¸­å¼•ç”¨å¦ä¸€ä¸ªMakefileï¼Œå°±åƒCè¯­è¨€ä¸­çš„includeä¸€æ ·ï¼›å¦ä¸€ä¸ªæ˜¯æŒ‡æ ¹æ®æŸäº›æƒ…å†µæŒ‡å®šMakefileä¸­çš„æœ‰æ•ˆéƒ¨åˆ†ï¼Œå°±åƒCè¯­è¨€ä¸­çš„é¢„ç¼–è¯‘#ifä¸€ æ ·ï¼›è¿˜æœ‰å°±æ˜¯å®šä¹‰ä¸€ä¸ªå¤šè¡Œçš„å‘½ä»¤ã€‚æœ‰å…³è¿™ä¸€éƒ¨åˆ†çš„å†…å®¹ï¼Œæˆ‘ä¼šåœ¨åç»­çš„éƒ¨åˆ†ä¸­è®²è¿°ã€‚</li>
<li>æ³¨é‡Šã€‚Makefileä¸­åªæœ‰è¡Œæ³¨é‡Šï¼Œå’ŒUNIXçš„Shellè„šæœ¬ä¸€æ ·ï¼Œå…¶æ³¨é‡Šæ˜¯ç”¨ # å­—ç¬¦ï¼Œè¿™ä¸ªå°± åƒC/C++ä¸­çš„//ä¸€æ ·ã€‚å¦‚æœä½ è¦åœ¨ä½ çš„Makefileä¸­ä½¿ç”¨ # å­—ç¬¦ï¼Œå¯ä»¥ç”¨åæ–œæ è¿›è¡Œ è½¬ä¹‰ï¼Œå¦‚ï¼š # ã€‚</li>
</ol>
<p>æœ€åï¼Œè¿˜å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨Makefileä¸­çš„å‘½ä»¤ï¼Œå¿…é¡»è¦ä»¥ Tab é”®å¼€å§‹ã€‚</p>
<h3 id="å¼•ç”¨å…¶å®ƒmakefile">å¼•ç”¨å…¶å®ƒmakefile</h3>
<pre><code class="language-makefile"># filename å¯åŒ…å«è·¯å¾„å’Œé€šé…ç¬¦
include &lt;filname&gt;
</code></pre>
<p>include å‰å¯æœ‰ç©ºæ ¼ï¼Œbutç»ä¸å¯ä»¥ Tab é”®å¼€å§‹ï¼Œmakeå‘½ä»¤å¼€å§‹æ—¶ï¼Œä¼šæ‰¾å¯» include æ‰€æŒ‡å‡ºçš„å…¶å®ƒMakefileï¼Œå¹¶æŠŠå…¶å†…å®¹åœ¨å½“å‰çš„ä½ç½®å±•å¼€ã€‚å¦‚æœæ–‡ä»¶éƒ½æ²¡æœ‰æŒ‡å®šç»å¯¹è·¯å¾„æˆ–æ˜¯ç›¸å¯¹è·¯å¾„çš„è¯ï¼Œmakeä¼šåœ¨å½“å‰ç›®å½•ä¸‹é¦–å…ˆå¯»æ‰¾ï¼Œå¦‚æœå½“å‰ç›®å½•ä¸‹æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆï¼Œmakeè¿˜ä¼šåœ¨ä¸‹é¢çš„å‡ ä¸ªç›®å½•ä¸‹æ‰¾ã€‚</p>
<ol>
<li>å¦‚æœmakeæ‰§è¡Œæ—¶ï¼Œæœ‰ -I æˆ– --include-dir å‚æ•°ï¼Œé‚£ä¹ˆmakeå°±ä¼šåœ¨è¿™ä¸ªå‚æ•°æ‰€æŒ‡å®šçš„ç›® å½•ä¸‹å»å¯»æ‰¾ã€‚</li>
<li>å¦‚æœç›®å½• <prefix>/include ï¼ˆä¸€èˆ¬æ˜¯ï¼š /usr/local/bin æˆ– /usr/include ï¼‰å­˜åœ¨çš„è¯ï¼Œmakeä¹Ÿä¼šå»æ‰¾ã€‚</li>
</ol>
<p>å¦‚æœæœ‰æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼Œmakeä¼šç”Ÿæˆä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼Œä½†ä¸ä¼šé©¬ä¸Šå‡ºç°è‡´å‘½é”™è¯¯ã€‚å®ƒä¼šç»§ç»­è½½å…¥å…¶å®ƒçš„æ–‡ä»¶ï¼Œä¸€æ—¦å®Œæˆmakefileçš„è¯»å–ï¼Œmakeä¼šå†é‡è¯•è¿™äº›æ²¡æœ‰æ‰¾åˆ°ï¼Œæˆ–æ˜¯ä¸èƒ½è¯»å–çš„æ–‡ä»¶ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œmakeæ‰ä¼šå‡ºç°ä¸€æ¡è‡´å‘½ä¿¡æ¯ã€‚å¦‚æœä½ æƒ³è®©makeä¸ç†é‚£äº›æ— æ³•è¯»å–çš„æ–‡ä»¶ï¼Œè€Œç»§ç»­æ‰§è¡Œï¼Œä½ å¯ä»¥ åœ¨includeå‰åŠ ä¸€ä¸ªå‡å·â€œ-â€ã€‚å¦‚ï¼š</p>
<pre><code># - é”™è¯¯è·³è¿‡
-include &lt;filename&gt;
</code></pre>
<h3 id="æ‰§è¡Œé¡ºåº">æ‰§è¡Œé¡ºåº</h3>
<ol>
<li>
<p>è¯»å…¥æ‰§è¡Œçš„Makefileã€‚</p>
</li>
<li>
<p>è¯»å…¥è¢«includeçš„å…¶å®ƒMakefileã€‚</p>
</li>
<li>
<p>åˆå§‹åŒ–æ–‡ä»¶ä¸­çš„å˜é‡ã€‚</p>
<pre><code> Note: targetç›®æ ‡å˜é‡æ­¤æ—¶ä¸ä¼šå±•å¼€æ±‚å€¼ï¼ï¼ï¼
 Note: è¯»å–Makefileæ—¶å°±è®¡ç®—æ¡ä»¶è¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶æ ¹æ®æ¡ä»¶è¡¨è¾¾å¼çš„å€¼æ¥é€‰æ‹©è¯­å¥ã€‚ 
   PS:ï¼ˆä¸ªäººç†è§£ï¼š 1, 2 æ˜¯åŒ…å« 3 çš„ï¼Œè¯»å…¥çš„åŒæ—¶åˆå§‹åŒ–å˜é‡ï¼‰
</code></pre>
</li>
<li>
<p>æ¨å¯¼éšæ™¦è§„åˆ™ï¼Œå¹¶åˆ†ææ‰€æœ‰è§„åˆ™ã€‚</p>
</li>
<li>
<p>ä¸ºæ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶åˆ›å»ºä¾èµ–å…³ç³»é“¾ã€‚</p>
</li>
<li>
<p>æ ¹æ®ä¾èµ–å…³ç³»ï¼Œå†³å®šå“ªäº›ç›®æ ‡è¦é‡æ–°ç”Ÿæˆã€‚</p>
<pre><code> Note: æ‰§è¡Œå‘½ä»¤å‰ï¼Œä¼šå±•å¼€æ‰€æœ‰$(varname)å˜é‡è¿›è¡Œæ±‚å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¯¥å˜é‡ï¼Œåˆ™è¿”å›å¯¹åº”çš„stringï¼Œ``ï¼ˆegï¼š$(songhanghang) æ‰¾ä¸åˆ°åˆ™è¿”å›songhanghangï¼‰ï¼Œ
</code></pre>
</li>
<li>
<p>æ‰§è¡Œç”Ÿæˆå‘½ä»¤ã€‚</p>
<pre><code> Note: targetå˜é‡å·²ç»å±•å¼€æ±‚å€¼ï¼ï¼ï¼
       åœ¨commandä¸­å¼•ç”¨shellå˜é‡éœ€ä½¿ç”¨$$varnameï¼Œ (eg: $$(ls | grep &quot;haha&quot;) æ‰§è¡Œcommandæ—¶ä¼šå¯¹å…¶æ±‚å€¼)
</code></pre>
</li>
</ol>
<h2 id="makefileè§„åˆ™">Makefileè§„åˆ™</h2>
<h3 id="è¯­æ³•">è¯­æ³•</h3>
<ul>
<li>è§„åˆ™åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ä¾èµ–å…³ç³»ï¼Œä¸€ä¸ªæ˜¯ç”Ÿæˆç›®æ ‡çš„æ–¹æ³•</li>
<li>command å‰é¢å¿…é¡»ä»¥tabå¼€å¤´ï¼Œå¦‚æœcommandè¿‡é•¿å¯ä»¥ä½¿ç”¨åæ–œæ â€œ\â€è¿›è¡Œæ¢è¡Œ</li>
<li>command ä¼šä»¥UNIXçš„æ ‡å‡†Shellè¿›è¡Œæ‰§è¡Œï¼Œå³<code>/bin/sh</code>æ¥æ‰§è¡Œå‘½ä»¤</li>
</ul>
<pre><code class="language-makefile"># ä¾èµ–å…³ç³»
targets : prerequisites
# ç›®æ ‡ç”Ÿæˆæ–¹æ³•
    command
    ...
</code></pre>
<p>æˆ–è€…</p>
<pre><code class="language-makefile"># ä¾èµ–å…³ç³»                ç›®æ ‡ç”Ÿæˆæ–¹æ³•
targets : prerequisites; command
    command
    ...
</code></pre>
<h3 id="é€šé…ç¬¦">é€šé…ç¬¦</h3>
<p>é€šé…ç¬¦å’ŒUNIXçš„Shellä¸€è‡´</p>
<pre><code>*.mtz     æ‰€æœ‰åç¼€mtzçš„æ–‡ä»¶  
~/miui     æ ¹ç›®å½•ä¸‹çš„miuiæ–‡ä»¶ï¼Œå³$HOME/miui
...
</code></pre>
<h3 id="æ–‡ä»¶æœç´¢">æ–‡ä»¶æœç´¢</h3>
<p>makeåœ¨æŸ¥æ‰¾æ–‡ä»¶ä¾èµ–æ—¶å¯ä»¥æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œï¼ˆegï¼š/Users/songhang/miuidevï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <em><strong>ç‰¹æ®Šå˜é‡ <code>VPATH</code></strong></em> æ¥å‘Šè¯‰makeè·¯å¾„ï¼Œè®©å…¶è‡ªåŠ¨æŸ¥æ‰¾ã€‚å½“makeåœ¨å½“å‰ç›®å½•æ‰¾ä¸åˆ°æ—¶ï¼Œåˆ™ä¼šåˆ°æŒ‡å®šçš„ç›®å½•è¿›è¡ŒæŸ¥æ‰¾ã€‚</p>
<pre><code># ç”± ï¼šâ€œå†’å·â€åˆ†å‰²ï¼ŒæŒ‰ç…§å…ˆåé¡ºåºæŸ¥æ‰¾
VPATH = theme ï¼š ../miui
</code></pre>
<p>å¦å¯ä»¥é€šè¿‡ ***å…³é”®å­— <code>vpath</code>***æ›´çµæ´»çš„æ§åˆ¶æœç´¢ç›®å½•ï¼Œæ³¨æ„æ˜¯å…³é”®å­—ä¸æ˜¯å˜é‡ã€‚</p>
<pre><code># Note: vapthä½¿ç”¨æ–¹æ³•ä¸­çš„&lt;pattern&gt;éœ€è¦åŒ…å« % å­—ç¬¦ï¼Œ% çš„æ„æ€æ˜¯åŒ¹é…é›¶æˆ–è‹¥å¹²å­—ç¬¦

# ä¸ºç¬¦åˆæ¨¡å¼&lt;pattern&gt;çš„æ–‡ä»¶æŒ‡å®šæœç´¢ç›®å½•&lt;directories&gt;
vpath &lt;pattern&gt; &lt;directories&gt;

# egï¼šä»å¹³çº§ç›®å½•miuiä¸­æŸ¥æ‰¾æ‰€æœ‰åç¼€mtzæ–‡ä»¶
vpath %.mtz ../miui

# æ¸…é™¤ç¬¦åˆæ¨¡å¼&lt;pattern&gt;çš„æ–‡ä»¶çš„æœç´¢ç›®å½•
vpath &lt;pattern&gt;

# egï¼šæ¸…é™¤ä¹‹å‰å®šä¹‰çš„../miuiæœç´¢ç›®å½•
vpath %.mtz

# æ¸…é™¤æ‰€æœ‰å·²è¢«è®¾ç½®å¥½äº†çš„æ–‡ä»¶æœç´¢ç›®å½•
vpath
</code></pre>
<h3 id="ä¼ªç›®æ ‡">ä¼ªç›®æ ‡</h3>
<pre><code>.PHONY : clean
clean:
    rm -rf miui/out
</code></pre>
<p><code>.PHONY</code> å³æ˜¯è¿™ä¸ªä¼ªç›®æ ‡ï¼Œå› ä¸ºå¹¶ä¸ç”Ÿæˆ <code>clean</code> æ–‡ä»¶ï¼Œæ‰€ä»¥ä¼ªç›®æ ‡å¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œåªæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œmakeæ— æ³•ç”Ÿæˆå®ƒçš„ä¾èµ–å…³ç³»å’Œå†³å®šä»–æ˜¯å¦æ‰§è¡Œï¼Œåªæœ‰é€šè¿‡æ˜¾å¼çš„æŒ‡å®šè¿™ä¸ª&quot;ç›®æ ‡&quot; <code>make clean</code> æ‰èƒ½ä½¿å…¶æ‰§è¡Œï¼Œä¸ºé¿å…ä¸æ–‡ä»¶é‡åï¼Œä¸€èˆ¬ä½¿ç”¨ <code>.PHONY</code> æ¥æ˜¾å¼æŒ‡æ˜è¿™ä¸ªä¼ªç›®æ ‡ã€‚<br>
ä¼ªç›®æ ‡ä¸€èˆ¬æ²¡æœ‰ä¾èµ–çš„æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä¹Ÿå¯ä»¥ä¸ºä¼ªç›®æ ‡æŒ‡å®šæ‰€ä¾èµ–çš„æ–‡ä»¶ã€‚</p>
<h3 id="å¤šç›®æ ‡">å¤šç›®æ ‡</h3>
<pre><code>target1 target2 : /miui/icons
zip -rq /miui/icons $@
</code></pre>
<p>ç­‰ä»·äº</p>
<pre><code># $@ == target1
target1 : /miui/icons
zip -rq /miui/icons $@

# $@ == target2
target2 : /miui/icons
zip -rq /miui/icons $@
</code></pre>
<h3 id="é™æ€æ¨¡å¼">é™æ€æ¨¡å¼</h3>
<pre><code># targetså®šä¹‰äº†ä¸€ç³»åˆ—çš„ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æœ‰é€šé…ç¬¦ã€‚æ˜¯ç›®æ ‡çš„ä¸€ä¸ªé›†åˆ
# target-parrternæ˜¯æŒ‡æ˜äº†targetsçš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯çš„ç›®æ ‡é›†æ¨¡å¼
# prereq-parrternsæ˜¯ç›®æ ‡çš„ä¾èµ–æ¨¡å¼ï¼Œå®ƒå¯¹target-parrternå½¢æˆçš„æ¨¡å¼å†è¿›è¡Œä¸€æ¬¡ä¾èµ–ç›®æ ‡çš„å®šä¹‰
&lt;targets ...&gt; : &lt;target-pattern&gt; : &lt;prereq-patterns ...&gt;
    &lt;commands&gt;
    ...
   
# åŒ¹é… targets ä¸­ä»¥.oä¸ºåç¼€çš„ targetï¼Œç”¨å¯¹åº”çš„miui1.c miui2.c ç¼–è¯‘ç”Ÿæˆ
targets = miui1.o miui2.o
$(targets) : %.o : %.c
...
</code></pre>
<p>ç­‰ä»·äº</p>
<pre><code>miui1.o : miui1.c
...
miui2.o : miui2.c
...
</code></pre>
<h3 id="è‡ªåŠ¨ç”Ÿæˆä¾èµ–">è‡ªåŠ¨ç”Ÿæˆä¾èµ–</h3>
<pre><code># æŠŠå˜é‡ä¸­æ‰€æœ‰.cæ¢æˆ.mk
sources = miui1.c miui2.c

include $(sources:.c=.mk)
</code></pre>
<p>ç­‰ä»·äº</p>
<pre><code>include miui1.mk
include miui2.mk
</code></pre>
<h2 id="makefileå‘½ä»¤">Makefileå‘½ä»¤</h2>
<h3 id="æ˜¾ç¤ºå‘½ä»¤">æ˜¾ç¤ºå‘½ä»¤</h3>
<p>é»˜è®¤æ‰§è¡Œ command æ—¶ä¼šæ‰“å°è¯¥ commandï¼Œå¦‚æœä¸æƒ³æ‰“å°è¯¥ command å¯ä»¥åœ¨å‰åŠ  <code>@</code></p>
<pre><code># command
echo æ­£åœ¨ç¼–è¯‘miui...
</code></pre>
<p>è¾“å‡ºç»“æœ</p>
<pre><code>echo æ­£åœ¨ç¼–è¯‘miui...
æ­£åœ¨ç¼–è¯‘miui...
</code></pre>
<pre><code># command
@echo æ­£åœ¨ç¼–è¯‘miui...
</code></pre>
<p>è¾“å‡ºç»“æœ</p>
<pre><code>æ­£åœ¨ç¼–è¯‘miui...
</code></pre>
<p>åªæ˜¾ç¤ºå‘½ä»¤ï¼Œä½†ä¸æ‰§è¡Œå‘½ä»¤ï¼Œæ–¹ä¾¿ç”¨äºè°ƒè¯•makefile</p>
<pre><code>make -n
make --just-print
</code></pre>
<p>å®‰é™æ‰§è¡Œï¼Œä¸æ˜¾ç¤ºå‘½ä»¤</p>
<pre><code>make -s
make --silent
make --quiet
</code></pre>
<h3 id="å‘½ä»¤æ‰§è¡Œ">å‘½ä»¤æ‰§è¡Œ</h3>
<ul>
<li>æ¯è¡Œå‘½ä»¤å¤„äºç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œç”¨åŸŸé™äºå½“å‰è¡Œï¼Œç¦»å¼€å½“å‰è¡Œå¤±æ•ˆã€‚</li>
<li>å¯ä»¥ç”¨ <code>;</code> åˆ†éš”å†™åœ¨ä¸€è¡Œè¡¨ç¤ºä¸€è¡Œã€‚</li>
<li>å¯ä»¥ç”¨ <code>;\</code> åˆ†éš”å†™åœ¨ä¸¤è¡Œè¡¨ç¤ºä¸€è¡Œã€‚</li>
</ul>
<pre><code># pwd è¾“å‡ºæ ¹ç›®å½• eg: /songhang/
cd miui/icons
pwd

# pwd è¾“å‡º miui/icons
cd miui/icons; pwd

# pwd è¾“å‡º miui/icons
cd miui/icons;\
pwd
</code></pre>
<h3 id="å‘½ä»¤å‡ºé”™">å‘½ä»¤å‡ºé”™</h3>
<pre><code># æ‰§è¡Œå‘½ä»¤å¿½ç•¥é”™è¯¯
make -i
make --ignore-errors

# å¦‚æœæŸè§„åˆ™ä¸­çš„å‘½ä»¤å‡ºé”™äº†ï¼Œé‚£ä¹ˆå°±ç»ˆæ­¢è¯¥è§„åˆ™çš„æ‰§è¡Œï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶å®ƒè§„åˆ™
make -k
make --keep-going
</code></pre>
<p>è€Œå¦‚æœä¸€ä¸ªè§„åˆ™æ˜¯ä»¥ <code>.IGNORE</code> ä½œä¸ºç›®æ ‡çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªè§„åˆ™ä¸­çš„æ‰€æœ‰å‘½ä»¤å°†ä¼šå¿½ç•¥é”™è¯¯ã€‚</p>
<h3 id="åµŒå¥—æ‰§è¡Œmake">åµŒå¥—æ‰§è¡Œmake</h3>
<p>åµŒå¥—å‘½ä»¤æ‰§è¡Œmakeï¼Œå¯ä»¥ä¸é€šè¿‡<code>include</code>æ‰§è¡Œå…¶ä»–makefile</p>
<pre><code>cgoogle:
    cd googledir &amp;&amp; $(MAKE)
</code></pre>
<p>ç­‰ä»·äº</p>
<pre><code>cgoogle:
    $(MAKE) -C googledir
</code></pre>
<h3 id="å®šä¹‰å‘½ä»¤åŒ…">å®šä¹‰å‘½ä»¤åŒ…</h3>
<p>å¦‚æœmakefileä¸­å‡ºç°ç›¸åŒå‘½ä»¤åºåˆ—ï¼Œé‚£ä¹ˆå¯ä»¥ä¸ºå…¶å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œç±»ä¼¼äºå®šä¹‰æ–¹æ³•ã€‚</p>
<pre><code># $@ == mi6 $^ == Snapdragon835
define makemi
    zip -rq $@ $^
endef

mi6 : Snapdragon835
    $(makemi)
</code></pre>
<h2 id="makefileå˜é‡">Makefileå˜é‡</h2>
<h3 id="å˜é‡åŸºç¡€">å˜é‡åŸºç¡€</h3>
<p>å˜é‡å£°æ˜æ—¶éœ€è¦èµ‹äºˆåˆå€¼ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰é¢åŠ  <code>$</code> ï¼Œç„¶åç”¨ <code>()</code> æŠŠå˜é‡åŒ…èµ·æ¥ã€‚</p>
<p>Note:</p>
<pre><code># Note: å£°æ˜å˜é‡æ—¶æ·»åŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªç©ºæ ¼ä»¥åå¢åŠ #æ³¨é‡Šï¼Œä¼šå¯¹è¯¥å˜é‡å¢åŠ ä¸€ä¸ªç©ºæ ¼
dir := /miui/icons    # directory to miui icons
all :
# æ­¤å¤„ä¼šerrorï¼Œå› /miui/icons /resæ‰¾ä¸åˆ°
    cd $(dir)/res/
</code></pre>
<h3 id="å˜é‡ä¸­å¼•ç”¨å˜é‡">å˜é‡ä¸­å¼•ç”¨å˜é‡</h3>
<pre><code># ç”¨ = ç­‰å·èµ‹å€¼ï¼Œå‰é¢çš„å˜é‡å¯ä»¥å¼•ç”¨åé¢çš„å˜é‡
a = $(b)
b = $(c)
c = are you ok ?
all:
    @echo $(a)
</code></pre>
<p>è¾“å‡ºç»“æœ</p>
<pre><code>are you ok ?
</code></pre>
<pre><code># ç”¨ := ç­‰å·èµ‹å€¼ï¼Œå‰é¢çš„å˜é‡ä¸å¯ä»¥å¼•ç”¨åé¢çš„å˜é‡
a := $(b)
b := $(c)
c := are you ok ?
all:
    @echo $(a)
</code></pre>
<p>è¾“å‡ºç»“æœ</p>
<pre><code># æ— è¾“å‡º
</code></pre>
<pre><code># å¦‚æœbuyPhoneæ²¡æœ‰è¢«å®šä¹‰è¿‡ï¼Œåˆ™èµ‹å€¼mix2ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åš
buyPhone ?= mix2
</code></pre>
<p>ç­‰ä»·äº</p>
<pre><code class="language-makefile">ifeq ($(origin buyPhone), undefined)
    buyPhone = mix2
endif
</code></pre>
<h3 id="å˜é‡é«˜çº§ç”¨æ³•">å˜é‡é«˜çº§ç”¨æ³•</h3>
<pre><code># $(var:a=b) æŠŠå˜é‡â€œvarâ€ä¸­æ‰€æœ‰ä»¥â€œaâ€å­—ä¸²â€œç»“å°¾â€çš„â€œaâ€æ›¿æ¢æˆâ€œbâ€å­—ä¸²
# themeMtz := é»˜è®¤.mtz æ— ç•Œ.mtz
themeZip := é»˜è®¤.zip æ— ç•Œ.zip
themeMtz := $(themeZip: .zip=.mtz)
</code></pre>
<h3 id="è¿½åŠ å˜é‡">è¿½åŠ å˜é‡</h3>
<pre><code># += è¿½åŠ å˜é‡
# iconsPath = /miui/v6/common/theme/icons /miui/v6/common/devices/theme/icons
iconsPath := /miui/v6/common/theme/icons
iconsPath += /miui/v6/common/devices/theme/icons
</code></pre>
<h3 id="override-æŒ‡ç¤ºç¬¦">override æŒ‡ç¤ºç¬¦</h3>
<pre><code># å¦‚æœæœ‰å˜é‡æ˜¯é€šè¿‡makeçš„å‘½ä»¤è¡Œå‚æ•°è®¾ç½®çš„ï¼Œé‚£ä¹ˆMakefileä¸­å¯¹è¿™ä¸ªå˜é‡çš„èµ‹å€¼ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœä½ æƒ³åœ¨Makefileä¸­è®¾ç½®è¿™ç±»å‚æ•°çš„å€¼ï¼Œé‚£ä¹ˆï¼Œä½ å¯ä»¥ä½¿ç”¨â€œoverrideâ€æŒ‡ç¤ºç¬¦
override &lt;variable&gt;; = &lt;value&gt;;
override &lt;variable&gt;; := &lt;value&gt;;
# è¿½åŠ å˜é‡
override &lt;variable&gt;; += &lt;more text&gt;;
# å¯¹äºå¤šè¡Œçš„å˜é‡å®šä¹‰ï¼Œæˆ‘ä»¬ç”¨defineæŒ‡ç¤ºç¬¦ï¼Œåœ¨defineæŒ‡ç¤ºç¬¦å‰ï¼Œä¹ŸåŒæ ·å¯ä»¥ä½¿ç”¨overrideæŒ‡ç¤ºç¬¦
override define foo
bar
endef
</code></pre>
<h3 id="å¤šè¡Œå˜é‡">å¤šè¡Œå˜é‡</h3>
<p>è¿˜æœ‰ä¸€ç§è®¾ç½®å˜é‡å€¼çš„æ–¹æ³•æ˜¯ä½¿ç”¨defineå…³é”®å­—ã€‚ä½¿ç”¨defineå…³é”®å­—è®¾ç½®å˜é‡çš„å€¼å¯ä»¥æœ‰æ¢è¡Œï¼Œè¿™æœ‰åˆ©äºå®šä¹‰ä¸€ç³»åˆ—çš„å‘½ä»¤ï¼ˆå‰é¢***Makefileå‘½ä»¤/å®šä¹‰å‘½ä»¤åŒ…***ä¹Ÿæ˜¯ä½¿ç”¨è¯¥å…³é”®å­—ï¼‰ã€‚</p>
<p><code>define</code> æŒ‡ç¤ºç¬¦åé¢è·Ÿçš„æ˜¯å˜é‡çš„åå­—ï¼Œè€Œé‡èµ·ä¸€è¡Œå®šä¹‰å˜é‡çš„å€¼ï¼Œå®šä¹‰æ˜¯ä»¥ <code>endef</code> å…³é”®å­—ç»“æŸã€‚å…¶å·¥ä½œæ–¹å¼å’Œ <code>=</code> æ“ä½œç¬¦ä¸€æ ·ã€‚å˜é‡çš„å€¼å¯ä»¥åŒ…å«å‡½æ•°ã€å‘½ä»¤ã€æ–‡å­—ï¼Œæˆ–æ˜¯å…¶å®ƒå˜é‡ã€‚å› ä¸ºå‘½ä»¤éœ€è¦ä»¥ <code>Tab</code> é”®å¼€å¤´ï¼Œ æ‰€ä»¥å¦‚æœä½ ç”¨ <code>define</code> å®šä¹‰çš„å‘½ä»¤å˜é‡ä¸­æ²¡æœ‰ä»¥ <code>Tab</code> é”®å¼€å¤´ï¼Œé‚£ä¹ˆmakeå°±ä¸ä¼šæŠŠå…¶è®¤ä¸ºæ˜¯å‘½ä»¤ã€‚</p>
<pre><code>define miphone
echo D1
echo D2
endef
</code></pre>
<h3 id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</h3>
<p>makeè¿è¡Œæ—¶çš„ç³»ç»Ÿç¯å¢ƒå˜é‡å¯ä»¥åœ¨makeå¼€å§‹è¿è¡Œæ—¶è¢«è½½å…¥åˆ°Makefileæ–‡ä»¶ä¸­ï¼Œä½†æ˜¯å¦‚æœMakefileä¸­å·²å®šä¹‰äº†è¿™ä¸ªå˜é‡ï¼Œæˆ–æ˜¯è¿™ä¸ªå˜é‡ç”±makeå‘½ä»¤è¡Œå¸¦å…¥ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„ç¯å¢ƒå˜é‡çš„å€¼å°†è¢«è¦†ç›–ã€‚ï¼ˆå¦‚æœmakeæŒ‡å®šäº†â€œ-eâ€å‚æ•°ï¼Œé‚£ä¹ˆï¼Œç³»ç»Ÿç¯å¢ƒå˜é‡å°†è¦†ç›–Makefileä¸­å®šä¹‰çš„å˜é‡ï¼‰</p>
<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®äº† CFLAGS ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨æ‰€æœ‰çš„Makefileä¸­ä½¿ç”¨è¿™ä¸ªå˜é‡äº†ã€‚è¿™å¯¹äºæˆ‘ä»¬ä½¿ç”¨ç»Ÿä¸€çš„ç¼–è¯‘å‚æ•°æœ‰æ¯”è¾ƒå¤§çš„å¥½å¤„ã€‚å¦‚æœMakefileä¸­å®šä¹‰äº†CFLAGSï¼Œé‚£ä¹ˆåˆ™ä¼šä½¿ç”¨Makefileä¸­çš„è¿™ä¸ªå˜é‡ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰åˆ™ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡çš„å€¼ï¼Œä¸€ä¸ªå…±æ€§å’Œä¸ªæ€§çš„ç»Ÿä¸€ï¼Œå¾ˆåƒâ€œå…¨å±€å˜é‡â€å’Œâ€œå±€éƒ¨å˜é‡â€çš„ç‰¹æ€§ã€‚</p>
<h3 id="ç›®æ ‡å˜é‡">ç›®æ ‡å˜é‡</h3>
<pre><code># ç›®æ ‡å˜é‡ä¸ºç›®æ ‡targetè®¾ç½®å±€éƒ¨å˜é‡ï¼Œè¿™ç§å˜é‡è¢«ç§°ä¸ºâ€œTarget-specific Variableâ€
# å®ƒå¯ä»¥å’Œâ€œå…¨å±€å˜é‡â€åŒåï¼Œå› ä¸ºå®ƒçš„ä½œç”¨èŒƒå›´åªåœ¨è¿™æ¡è§„åˆ™ä»¥åŠè¿å¸¦è§„åˆ™ä¸­ï¼Œæ‰€ä»¥å…¶å€¼ä¹Ÿåªåœ¨ä½œç”¨èŒƒå›´å†…æœ‰æ•ˆã€‚
# è€Œä¸ä¼šå½±å“è§„åˆ™é“¾ä»¥å¤–çš„å…¨å±€å˜é‡çš„å€¼ã€‚
 &lt;target ...&gt; : &lt;variable-assignment&gt;;
 &lt;target ...&gt; : overide &lt;variable-assignment&gt;
 
# eg:
$(default_theme): PRIVATE_OUT_THEME_PATH := $(ANDROID_PRODUCT_OUT)/system/media/theme
</code></pre>
<h3 id="æ¨¡å¼å˜é‡">æ¨¡å¼å˜é‡</h3>
<pre><code># æ¨¡å¼å˜é‡ä¸ºç›®æ ‡targetç»™å®šä¸€ç§â€œæ¨¡å¼â€ï¼Œå¯ä»¥æŠŠå˜é‡å®šä¹‰åœ¨ç¬¦åˆè¿™ç§æ¨¡å¼çš„æ‰€æœ‰ç›®æ ‡ä¸Šã€‚
# è¿™ç§å˜é‡è¢«ç§°ä¸º(Pattern-specific Variableï¼‰ã€‚
# makeçš„â€œæ¨¡å¼â€ä¸€èˆ¬æ˜¯è‡³å°‘å«æœ‰ä¸€ä¸ª % çš„ï¼Œ
# &lt;pattern ...&gt;; : &lt;variable-assignment&gt;;
# &lt;pattern ...&gt;; : override &lt;variable-assignment&gt;;
# ä¸ºæ‰€æœ‰åç¼€ä¸ºmtzçš„ç›®æ ‡è®¾ç½®ç›®æ ‡å˜é‡version = 1
%.mtz : version = 1
</code></pre>
<h2 id="makefileæ¡ä»¶åˆ¤æ–­">Makefileæ¡ä»¶åˆ¤æ–­</h2>
<h3 id="è¯­æ³•-2">è¯­æ³•</h3>
<pre><code># ç­‰ä»·äº java 
# if () {
#   ...
# }
# 
# endif ç»“æŸç¬¦æœ€è¿‘è·ç¦»é…å¯¹
&lt;conditional-directive&gt;
&lt;text-if-true&gt;
endif
</code></pre>
<p>æˆ–è€…</p>
<pre><code># ç­‰ä»·äº java 
# if () {
#   ...
# } else {
#   ...
# }
#
# endif ç»“æŸç¬¦æœ€è¿‘è·ç¦»é…å¯¹
&lt;conditional-directive&gt;
&lt;text-if-true&gt;
else
&lt;text-if-false&gt;
endif
</code></pre>
<p>&lt;conditional-directive&gt; æŒ‡ç¤ºæ¡ä»¶æœ‰ <code>ifeq</code>ã€<code>ifneq</code>ã€<code>ifdef</code>ã€<code>ifndef</code> å…³é”®å­—å¼€å¤´ï¼ŒæŒ‡ç¤ºæ¡ä»¶ä¸èƒ½ä»¥ <code>tab</code> å¼€å¤´ï¼ŒæŒ‡ç¤ºæ¡ä»¶åå¿…é¡»æœ‰ç©ºæ ¼ <code></code> ã€‚</p>
<p>Note: makeæ˜¯åœ¨è¯»å–Makefileæ—¶å°±è®¡ç®—æ¡ä»¶è¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶æ ¹æ®æ¡ä»¶è¡¨è¾¾å¼çš„å€¼æ¥é€‰æ‹©è¯­å¥ï¼Œ æ‰€ä»¥ï¼Œæœ€å¥½ä¸è¦æŠŠè‡ªåŠ¨åŒ–å˜é‡ï¼ˆå¦‚ <code>$@</code> ç­‰ï¼‰æ”¾å…¥æ¡ä»¶è¡¨è¾¾å¼ä¸­ï¼Œå› ä¸ºè‡ªåŠ¨åŒ–å˜é‡æ˜¯åœ¨è¿è¡Œæ—¶æ‰æœ‰çš„ã€‚</p>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3>
<pre><code>mifans := true
rich = 

ifeq (true, mifans)
ifdef rich 
# buy mix2
else 
# buy red4x
endif # endif å¯¹åº” ifdef rich 
else
# can try mi phone
endif # endif å¯¹åº” ifeq (true, mifans)
</code></pre>
<h2 id="makefileå‡½æ•°">Makefileå‡½æ•°</h2>
<h3 id="è¯­æ³•-3">è¯­æ³•</h3>
<pre><code># &lt;function&gt; å‡½æ•°å
# &lt;arguments&gt; å‚æ•°
# å‡½æ•°åä¸å‚æ•°ä¹‹é—´ä»¥ &quot;ç©ºæ ¼&quot; åˆ†å‰² ; å‚æ•°é—´ä»¥é€—å· &quot;,&quot; åˆ†å‰²; å‡½æ•°è°ƒç”¨ä»¥ &quot;$&quot; å¼€å¤´ã€‚
$(&lt;function&gt; &lt;arguments&gt;)
</code></pre>
<p>æˆ–è€…</p>
<pre><code>${&lt;function&gt; &lt;arguments&gt;}
</code></pre>
<h3 id="å­—ç¬¦ä¸²å¤„ç†å‡½æ•°">å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</h3>
<pre><code># å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°
$(subst &lt;from&gt;,&lt;to&gt;,&lt;text&gt;)

# æ¨¡å¼å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°
$(patsubst &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)

# å»ç©ºæ ¼å‡½æ•°
$(strip &lt;string&gt;)

# æŸ¥æ‰¾å­—ç¬¦ä¸²å‡½æ•°
$(findstring &lt;find&gt;,&lt;in&gt;)

# è¿‡æ»¤å‡½æ•°
$(filter &lt;pattern...&gt;,&lt;text&gt;)

# åè¿‡æ»¤å‡½æ•°
$(filter-out &lt;pattern...&gt;,&lt;text&gt;)

# æ’åºå‡½æ•°
$(sort &lt;list&gt;)

# å–å•è¯å‡½æ•°
$(word &lt;n&gt;,&lt;text&gt;)

# å–å•è¯ä¸²å‡½æ•°
$(wordlist &lt;ss&gt;,&lt;e&gt;,&lt;text&gt;)

# å•è¯ä¸ªæ•°ç»Ÿè®¡å‡½æ•°
$(words &lt;text&gt;)

# é¦–å•è¯å‡½æ•°â€”â€”firstword
$(firstword &lt;text&gt;)
</code></pre>
<h3 id="æ–‡ä»¶å¤„ç†å‡½æ•°">æ–‡ä»¶å¤„ç†å‡½æ•°</h3>
<pre><code># å–ç›®å½•å‡½æ•°â€”â€”dir
$(dir &lt;names...&gt;)

# å–æ–‡ä»¶å‡½æ•°â€”â€”notdir
$(notdir &lt;names...&gt;)

# å–åç¼€å‡½æ•°â€”â€”suffixã€‚
$(suffix &lt;names...&gt;)

# å–å‰ç¼€å‡½æ•°â€”â€”basename
$(basename &lt;names...&gt;)

# åŠ åç¼€å‡½æ•°â€”â€”addsuffix
$(addsuffix &lt;suffix&gt;,&lt;names...&gt;)

# åŠ å‰ç¼€å‡½æ•°â€”â€”addprefix
$(addprefix &lt;prefix&gt;,&lt;names...&gt;)

# è¿æ¥å‡½æ•°â€”â€”join
$(join &lt;list1&gt;,&lt;list2&gt;)
</code></pre>
<h3 id="foreach-å¾ªç¯å‡½æ•°">foreach å¾ªç¯å‡½æ•°</h3>
<pre><code># &lt;var&gt; å˜é‡å
# &lt;list&gt; é›†åˆï¼Œä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼
# &lt;text&gt; ä½¿ç”¨ &lt;var&gt; å‚æ•°ä¾èµ–æšä¸¾ &lt;list&gt; ä¸­å•è¯

# å‚æ•° &lt;list&gt; ä¸­çš„å•è¯é€ä¸€å–å‡ºæ”¾åˆ°å‚æ•° &lt;var&gt; æ‰€æŒ‡å®šçš„å˜é‡ä¸­ï¼Œ ç„¶åå†æ‰§è¡Œ &lt;text&gt; æ‰€åŒ…å«çš„è¡¨è¾¾å¼ã€‚
# æ¯ä¸€æ¬¡ &lt;text&gt; ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¾ªç¯è¿‡ç¨‹ä¸­ï¼Œ&lt;text&gt; çš„æ‰€è¿”å›çš„æ¯ä¸ªå­—ç¬¦ä¸²ä¼šä»¥ç©ºæ ¼åˆ†éš”ï¼Œæœ€åå½“æ•´ä¸ªå¾ªç¯ç»“æŸæ—¶ï¼Œ
# &lt;text&gt; æ‰€è¿”å›çš„æ¯ä¸ªå­—ç¬¦ä¸²æ‰€ç»„æˆçš„æ•´ä¸ªå­—ç¬¦ä¸²ï¼ˆä»¥ç©ºæ ¼åˆ†éš”ï¼‰å°†ä¼šæ˜¯foreachå‡½æ•°çš„è¿”å›å€¼ 

$(foreach &lt;var&gt;,&lt;list&gt;,&lt;text&gt;)

</code></pre>
<h3 id="ifå‡½æ•°">ifå‡½æ•°</h3>
<p>ifå‡½æ•°å¾ˆåƒmakeæ¡ä»¶è¯­å¥ <code>ifeq</code> ã€‚</p>
<pre><code># &lt;condition&gt; æ¡ä»¶
# &lt;then-part&gt; æ¡ä»¶æˆç«‹æ‰§è¡Œ
$(if &lt;condition&gt;,&lt;then-part&gt;)
</code></pre>
<p>æˆ–è€…</p>
<pre><code># &lt;condition&gt; æ¡ä»¶
# &lt;then-part&gt; æ¡ä»¶æˆç«‹æ‰§è¡Œ
# &lt;else-part&gt; æ¡ä»¶ä¸æˆç«‹æ‰§è¡Œ
$(if &lt;condition&gt;,&lt;then-part&gt;,&lt;else-part&gt;)
</code></pre>
<h3 id="call-å‡½æ•°">call å‡½æ•°</h3>
<h4 id="è¯­æ³•-4">è¯­æ³•</h4>
<pre><code># callå‡½æ•°æ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥ç”¨æ¥åˆ›å»ºæ–°çš„å‚æ•°åŒ–çš„å‡½æ•°ã€‚
# ä½ å¯ä»¥å†™ä¸€ä¸ªéå¸¸å¤æ‚çš„è¡¨è¾¾å¼ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œ
# ä½ å¯ä»¥å®šä¹‰è®¸å¤šå‚æ•°ï¼Œç„¶åä½ å¯ä»¥callå‡½æ•°æ¥å‘è¿™ä¸ªè¡¨è¾¾å¼ä¼ é€’å‚æ•°ã€‚

$(call &lt;expression&gt;,&lt;parm1&gt;,&lt;parm2&gt;,...,&lt;parmn&gt;)
</code></pre>
<h4 id="ç¤ºä¾‹-2">ç¤ºä¾‹</h4>
<pre><code># å½“makeæ‰§è¡Œè¿™ä¸ªå‡½æ•°æ—¶ï¼Œ &lt;expression&gt; å‚æ•°ä¸­çš„å˜é‡ï¼Œå¦‚ $(1) ã€ $(2) ç­‰ï¼Œ
# ä¼šè¢«å‚æ•° &lt;parm1&gt; ã€ &lt;parm2&gt; ã€ &lt;parm3&gt; ä¾æ¬¡å–ä»£ã€‚
# è€Œ &lt;expression&gt; çš„è¿”å›å€¼å°±æ˜¯ call å‡½æ•°çš„è¿”å›å€¼
showPhone := $(1) $(2) $(3)
result := $(call showPhone, mix2, red4x, iphoneX)
</code></pre>
<h3 id="originå‡½æ•°">originå‡½æ•°</h3>
<h4 id="è¯­æ³•-5">è¯­æ³•</h4>
<p>originå‡½æ•°ä¸åƒå…¶å®ƒçš„å‡½æ•°ï¼Œä»–å¹¶ä¸æ“ä½œå˜é‡çš„å€¼ï¼Œä»–åªæ˜¯å‘Šè¯‰ä½ ä½ çš„è¿™ä¸ªå˜é‡æ˜¯å“ªé‡Œæ¥çš„ï¼Ÿ</p>
<p>Note:  &lt;variable&gt; æ˜¯å˜é‡çš„åå­—ï¼Œä¸åº”è¯¥æ˜¯å¼•ç”¨ã€‚æ‰€ä»¥ä½ æœ€å¥½ä¸è¦åœ¨ &lt;variable&gt; ä¸­ä½¿ç”¨<br>
<code>$</code> å­—ç¬¦ã€‚Originå‡½æ•°ä¼šä»¥å…¶è¿”å›å€¼æ¥å‘Šè¯‰ä½ è¿™ä¸ªå˜é‡çš„â€œå‡ºç”Ÿæƒ…å†µâ€ï¼Œä¸‹é¢ï¼Œæ˜¯originå‡½æ•°çš„è¿”å›å€¼:<br>
<code>undefined</code><br>
å¦‚æœ &lt;variable&gt; ä»æ¥æ²¡æœ‰å®šä¹‰è¿‡ï¼Œoriginå‡½æ•°è¿”å›è¿™ä¸ªå€¼ undefined<br>
<code>default</code><br>
å¦‚æœ &lt;variable&gt; æ˜¯ä¸€ä¸ªé»˜è®¤çš„å®šä¹‰ï¼Œæ¯”å¦‚â€œCCâ€è¿™ä¸ªå˜é‡ï¼Œè¿™ç§å˜é‡æˆ‘ä»¬å°†åœ¨åé¢è®²è¿°ã€‚<br>
<code>environment</code><br>
å¦‚æœ &lt;variable&gt; æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”å½“Makefileè¢«æ‰§è¡Œæ—¶ï¼Œ -e å‚æ•°æ²¡æœ‰è¢«æ‰“å¼€ã€‚<br>
<code>file</code><br>
å¦‚æœ &lt;variable&gt; è¿™ä¸ªå˜é‡è¢«å®šä¹‰åœ¨Makefileä¸­ã€‚<br>
<code>command line</code><br>
å¦‚æœ &lt;variable&gt; è¿™ä¸ªå˜é‡æ˜¯è¢«å‘½ä»¤è¡Œå®šä¹‰çš„ã€‚<br>
<code>override</code><br>
å¦‚æœ &lt;variable&gt; æ˜¯è¢«overrideæŒ‡ç¤ºç¬¦é‡æ–°å®šä¹‰çš„ã€‚<br>
<code>automatic</code><br>
å¦‚æœ &lt;variable&gt; æ˜¯ä¸€ä¸ªå‘½ä»¤è¿è¡Œä¸­çš„è‡ªåŠ¨åŒ–å˜é‡ã€‚å…³äºè‡ªåŠ¨åŒ–å˜é‡å°†åœ¨åé¢è®²è¿°ã€‚</p>
<pre><code>$(origin &lt;variable&gt;)
</code></pre>
<h4 id="ç¤ºä¾‹-3">ç¤ºä¾‹</h4>
<pre><code># å¦‚æœICONS_PATHæ˜¯ç¯å¢ƒå˜é‡
ifeq (&quot;environment&quot;, $(origin ICONS_PATH))
# do someting
endif
</code></pre>
<h3 id="shellå‡½æ•°">Shellå‡½æ•°</h3>
<p>ä¸åŒäºå…¶ä»–å‡½æ•°ï¼Œå®ƒçš„å‚æ•°å°±æ˜¯æ“ä½œç³»ç»ŸShellçš„å‘½ä»¤ï¼Œä¸åå¼•å·  `  æ˜¯ç›¸åŒçš„åŠŸèƒ½ã€‚</p>
<p>Note: è¿™ä¸ªå‡½æ•°ä¼šæ–°ç”Ÿæˆä¸€ä¸ªShellç¨‹åºæ¥æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥è¦æ³¨æ„å…¶è¿è¡Œæ€§èƒ½ã€‚</p>
<p>Note: å¦‚æœæ‰§è¡Œåœ¨ <code>commond</code> ä¸­ï¼Œä¼šåœ¨æ‰§è¡Œå‰æå‰å±•å¼€ï¼Œéœ€è¦ä½¿ç”¨ <code>$$</code> æ‰èƒ½æ­£å¸¸æ‰§è¡Œã€‚</p>
<pre><code># è·å–å½“å‰ç›®å½•ä¸‹æ–‡ä»¶åˆ—è¡¨
icons := $(shell ls ./)
</code></pre>
<h3 id="æ§åˆ¶makeçš„å‡½æ•°">æ§åˆ¶makeçš„å‡½æ•°</h3>
<h4 id="è¯­æ³•-6">è¯­æ³•</h4>
<p>makeæä¾›äº†ä¸€äº›å‡½æ•°æ¥æ§åˆ¶makeçš„è¿è¡Œã€‚é€šå¸¸ï¼Œä½ éœ€è¦æ£€æµ‹ä¸€äº›è¿è¡ŒMakefileæ—¶çš„è¿è¡Œæ—¶ä¿¡æ¯ï¼Œå¹¶ä¸”æ ¹æ®è¿™äº›ä¿¡æ¯æ¥å†³å®šï¼Œè®©makeç»§ç»­æ‰§è¡Œï¼Œè¿˜æ˜¯åœæ­¢ã€‚</p>
<pre><code>$(error &lt;text ...&gt;)
</code></pre>
<p>è­¦å‘Šæ–¹æ³•ï¼Œåªè¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼Œç„¶åç»§ç»­æ‰§è¡Œã€‚</p>
<pre><code>$(warning &lt;text ...&gt;)
</code></pre>
<h4 id="ç¤ºä¾‹-4">ç¤ºä¾‹</h4>
<pre><code>$(error &quot;is time fc !&quot;)
$(warning &quot;dir not found!&quot;)
</code></pre>
<h2 id="makefileè¿è¡Œ">Makefileè¿è¡Œ</h2>
<h3 id="é€€å‡ºç ">é€€å‡ºç </h3>
<p>makeå‘½ä»¤æ‰§è¡Œåæœ‰ä¸‰ä¸ªé€€å‡ºç ï¼š</p>
<p>0<br>
è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚<br>
1<br>
å¦‚æœmakeè¿è¡Œæ—¶å‡ºç°ä»»ä½•é”™è¯¯ï¼Œå…¶è¿”å›1ã€‚<br>
2<br>
å¦‚æœä½ ä½¿ç”¨äº†makeçš„â€œ-qâ€é€‰é¡¹ï¼Œå¹¶ä¸”makeä½¿å¾—ä¸€äº›ç›®æ ‡ä¸éœ€è¦æ›´æ–°ï¼Œé‚£ä¹ˆè¿”å›2ã€‚</p>
<h3 id="æŒ‡å®šmakefile">æŒ‡å®šMakefile</h3>
<pre><code>make -f Android.mk
make --file Android.mk
make --makefile Android.mk
</code></pre>
<h3 id="æŒ‡å®šç›®æ ‡">æŒ‡å®šç›®æ ‡</h3>
<pre><code>.PHONY: all
all : a b
a :
    echo ---- aaaaa -----
b : 
    echo ---- bbbbb -----
</code></pre>
<p>æ‰§è¡Œè¾“å‡º</p>
<pre><code># è¾“å‡º ---- aaaaa -----, ---- bbbbb -----
make

# è¾“å‡º ---- aaaaa -----, ---- bbbbb -----
make all

# è¾“å‡º ---- aaaaa -----
make a

# è¾“å‡º ---- bbbbb -----
make b
</code></pre>
<h3 id="æ£€æŸ¥è§„åˆ™">æ£€æŸ¥è§„åˆ™</h3>
<p>æœ‰æ—¶å€™ä¸å¸Œæœ›makefileæ‰§è¡Œï¼Œåªæƒ³æ£€æŸ¥ä¸€ä¸‹å‘½ä»¤ï¼Œæˆ–æ˜¯æ‰§è¡Œçš„åºåˆ—ã€‚å¯ä»¥ä½¿ç”¨makeå‘½ä»¤çš„ä¸‹è¿°å‚æ•°ï¼š</p>
<p><code>-n</code> ,  <code>--just-print</code> , <code>--dry-run</code> ,  <code>--recon</code><br>
ä¸æ‰§è¡Œå‚æ•°ï¼Œè¿™äº›å‚æ•°åªæ˜¯æ‰“å°å‘½ä»¤ï¼Œä¸ç®¡ç›®æ ‡æ˜¯å¦æ›´æ–°ï¼ŒæŠŠè§„åˆ™å’Œè¿å¸¦è§„åˆ™ä¸‹çš„å‘½ä»¤æ‰“å°å‡ºæ¥ï¼Œä½†ä¸ æ‰§è¡Œï¼Œè¿™äº›å‚æ•°å¯¹äºæˆ‘ä»¬è°ƒè¯•makefileå¾ˆæœ‰ç”¨å¤„ã€‚<br>
<code>-t</code> ,  <code>--touch</code><br>
è¿™ä¸ªå‚æ•°çš„æ„æ€å°±æ˜¯æŠŠç›®æ ‡æ–‡ä»¶çš„æ—¶é—´æ›´æ–°ï¼Œä½†ä¸æ›´æ”¹ç›®æ ‡æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œmakeå‡è£…ç¼–è¯‘ç›®æ ‡ï¼Œä½†ä¸ æ˜¯çœŸæ­£çš„ç¼–è¯‘ç›®æ ‡ï¼Œåªæ˜¯æŠŠç›®æ ‡å˜æˆå·²ç¼–è¯‘è¿‡çš„çŠ¶æ€ã€‚<br>
<code>-q</code> ,  <code>--question</code><br>
è¿™ä¸ªå‚æ•°çš„è¡Œä¸ºæ˜¯æ‰¾ç›®æ ‡çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç›®æ ‡å­˜åœ¨ï¼Œé‚£ä¹ˆå…¶ä»€ä¹ˆä¹Ÿä¸ä¼šè¾“å‡ºï¼Œå½“ç„¶ä¹Ÿä¸ä¼šæ‰§è¡Œ ç¼–è¯‘ï¼Œå¦‚æœç›®æ ‡ä¸å­˜åœ¨ï¼Œå…¶ä¼šæ‰“å°å‡ºä¸€æ¡å‡ºé”™ä¿¡æ¯ã€‚<br>
<code>-W &lt;file&gt;</code> ,  <code>--what-if=&lt;file&gt;</code> ,  <code>--assume-new=&lt;file&gt;</code> ,  <code>--new-file=&lt;file&gt;</code><br>
è¿™ä¸ªå‚æ•°éœ€è¦æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ã€‚ä¸€èˆ¬æ˜¯æ˜¯æºæ–‡ä»¶ï¼ˆæˆ–ä¾èµ–æ–‡ä»¶ï¼‰ï¼ŒMakeä¼šæ ¹æ®è§„åˆ™æ¨å¯¼æ¥è¿è¡Œä¾èµ–äºè¿™ä¸ª æ–‡ä»¶çš„å‘½ä»¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥å’Œâ€œ-nâ€å‚æ•°ä¸€åŒä½¿ç”¨ï¼Œæ¥æŸ¥çœ‹è¿™ä¸ªä¾èµ–æ–‡ä»¶æ‰€å‘ç”Ÿçš„è§„åˆ™å‘½ä»¤</p>
<h3 id="makeçš„å‚æ•°">makeçš„å‚æ•°</h3>
<p><code>-b, -m</code><br>
è¿™ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯å¿½ç•¥å’Œå…¶å®ƒç‰ˆæœ¬makeçš„å…¼å®¹æ€§ã€‚</p>
<p><code>-B, --always-make</code><br>
è®¤ä¸ºæ‰€æœ‰çš„ç›®æ ‡éƒ½éœ€è¦æ›´æ–°ï¼ˆé‡ç¼–è¯‘ï¼‰ã€‚</p>
<p><code>-C &lt;dir&gt;, --directory=&lt;dir&gt;</code><br>
æŒ‡å®šè¯»å–makefileçš„ç›®å½•ã€‚å¦‚æœæœ‰å¤šä¸ªâ€œ-Câ€å‚æ•°ï¼Œmakeçš„è§£é‡Šæ˜¯åé¢çš„è·¯å¾„ä»¥å‰é¢çš„ä½œä¸ºç›¸å¯¹è·¯å¾„ ï¼Œå¹¶ä»¥æœ€åçš„ç›®å½•ä½œä¸ºè¢«æŒ‡å®šç›®å½•ã€‚å¦‚ï¼š<code>â€œmake -C ~hchen/test -C progâ€</code>ç­‰ä»·äº <code>â€œmake -C ~hchen/test/progâ€</code>ã€‚</p>
<p><code>-debug[=&lt;options&gt;]</code><br>
è¾“å‡ºmakeçš„è°ƒè¯•ä¿¡æ¯ã€‚å®ƒæœ‰å‡ ç§ä¸åŒçš„çº§åˆ«å¯ä¾›é€‰æ‹©ï¼Œå¦‚æœæ²¡æœ‰å‚æ•°ï¼Œé‚£å°±æ˜¯è¾“å‡ºæœ€ç®€å•çš„è°ƒè¯•ä¿¡æ¯ã€‚ ä¸‹é¢æ˜¯<options>çš„å–å€¼ï¼š</p>
<ul>
<li>a: ä¹Ÿå°±æ˜¯allï¼Œè¾“å‡ºæ‰€æœ‰çš„è°ƒè¯•ä¿¡æ¯ã€‚ï¼ˆä¼šéå¸¸çš„å¤šï¼‰</li>
<li>b: ä¹Ÿå°±æ˜¯basicï¼Œåªè¾“å‡ºç®€å•çš„è°ƒè¯•ä¿¡æ¯ã€‚å³è¾“å‡ºä¸éœ€è¦é‡ç¼–è¯‘çš„ç›®æ ‡ã€‚</li>
<li>v: ä¹Ÿå°±æ˜¯verboseï¼Œåœ¨bé€‰é¡¹çš„çº§åˆ«ä¹‹ä¸Šã€‚è¾“å‡ºçš„ä¿¡æ¯åŒ…æ‹¬å“ªä¸ªmakefileè¢«è§£æï¼Œä¸éœ€è¦è¢«é‡ç¼– è¯‘çš„ä¾èµ–æ–‡ä»¶ï¼ˆæˆ–æ˜¯ä¾èµ–ç›®æ ‡ï¼‰ç­‰ã€‚</li>
<li>i: ä¹Ÿå°±æ˜¯implicitï¼Œè¾“å‡ºæ‰€ä»¥çš„éšå«è§„åˆ™ã€‚</li>
<li>j: ä¹Ÿå°±æ˜¯jobsï¼Œè¾“å‡ºæ‰§è¡Œè§„åˆ™ä¸­å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å‘½ä»¤çš„PIDã€è¿”å›ç ç­‰ã€‚</li>
<li>m: ä¹Ÿå°±æ˜¯makefileï¼Œè¾“å‡ºmakeè¯»å–makefileï¼Œæ›´æ–°makefileï¼Œæ‰§è¡Œmakefileçš„ä¿¡æ¯ã€‚</li>
</ul>
<p><code>-d</code><br>
ç›¸å½“äºâ€œâ€“debug=aâ€ã€‚</p>
<p><code>-e, --environment-overrides</code>æŒ‡æ˜ç¯å¢ƒå˜é‡çš„å€¼è¦†ç›–makefileä¸­å®šä¹‰çš„å˜é‡çš„å€¼ã€‚</p>
<p><code>-f=&lt;file&gt;, --file=&lt;file&gt;, --makefile=&lt;file&gt;</code><br>
æŒ‡å®šéœ€è¦æ‰§è¡Œçš„makefileã€‚</p>
<p><code>-h, --help</code><br>
æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</p>
<p><code>-i , --ignore-errors</code><br>
åœ¨æ‰§è¡Œæ—¶å¿½ç•¥æ‰€æœ‰çš„é”™è¯¯ã€‚</p>
<p><code>-I &lt;dir&gt;, --include-dir=&lt;dir&gt;</code><br>
æŒ‡å®šä¸€ä¸ªè¢«åŒ…å«makefileçš„æœç´¢ç›®æ ‡ã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ªâ€œ-Iâ€å‚æ•°æ¥æŒ‡å®šå¤šä¸ªç›®å½•ã€‚</p>
<p><code>-j [&lt;jobsnum&gt;], --jobs[=&lt;jobsnum&gt;]</code><br>
æŒ‡åŒæ—¶è¿è¡Œå‘½ä»¤çš„ä¸ªæ•°ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œmakeè¿è¡Œå‘½ä»¤æ—¶èƒ½è¿è¡Œå¤šå°‘å°±è¿è¡Œå¤šå°‘ã€‚å¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„â€œ-jâ€å‚æ•°ï¼Œé‚£ä¹ˆä»…æœ€åä¸€ä¸ªâ€œ-jâ€æ‰æ˜¯æœ‰æ•ˆçš„ã€‚ï¼ˆæ³¨æ„è¿™ä¸ªå‚æ•°åœ¨MS-DOSä¸­æ˜¯æ— ç”¨çš„ï¼‰</p>
<p><code>-k, --keep-going</code><br>
å‡ºé”™ä¹Ÿä¸åœæ­¢è¿è¡Œã€‚å¦‚æœç”Ÿæˆä¸€ä¸ªç›®æ ‡å¤±è´¥äº†ï¼Œé‚£ä¹ˆä¾èµ–äºå…¶ä¸Šçš„ç›®æ ‡å°±ä¸ä¼šè¢«æ‰§è¡Œäº†ã€‚</p>
<p><code>-l &lt;load&gt;, --load-average[=&lt;load&gt;], -max-load[=&lt;load&gt;]</code><br>
æŒ‡å®šmakeè¿è¡Œå‘½ä»¤çš„è´Ÿè½½ã€‚</p>
<p><code>-n, --just-print, --dry-run, --recon</code><br>
ä»…è¾“å‡ºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„å‘½ä»¤åºåˆ—ï¼Œä½†å¹¶ä¸æ‰§è¡Œã€‚</p>
<p><code>-o &lt;file&gt;, --old-file=&lt;file&gt;, --assume-old=&lt;file&gt;</code><br>
ä¸é‡æ–°ç”Ÿæˆçš„æŒ‡å®šçš„<file>ï¼Œå³ä½¿è¿™ä¸ªç›®æ ‡çš„ä¾èµ–æ–‡ä»¶æ–°äºå®ƒã€‚</p>
<p><code>-p, --print-data-base</code><br>
è¾“å‡ºmakefileä¸­çš„æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„è§„åˆ™å’Œå˜é‡ã€‚è¿™ä¸ªå‚æ•°ä¼šè®©ä¸€ä¸ªç®€å•çš„makefileéƒ½ä¼šè¾“å‡ºä¸€å †ä¿¡æ¯ã€‚å¦‚æœä½ åªæ˜¯æƒ³è¾“å‡ºä¿¡æ¯è€Œä¸æƒ³æ‰§è¡Œmakefileï¼Œä½ å¯ä»¥ä½¿ç”¨<code>â€œmake -qpâ€</code>å‘½ä»¤ã€‚å¦‚æœä½ æƒ³æŸ¥çœ‹æ‰§è¡Œmakefileå‰çš„é¢„è®¾å˜é‡å’Œè§„åˆ™ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>â€œmake â€“p â€“f /dev/nullâ€</code>ã€‚è¿™ä¸ªå‚æ•°è¾“å‡ºçš„ ä¿¡æ¯ä¼šåŒ…å«ç€ä½ çš„makefileæ–‡ä»¶çš„æ–‡ä»¶åå’Œè¡Œå·ï¼Œæ‰€ä»¥ï¼Œç”¨è¿™ä¸ªå‚æ•°æ¥è°ƒè¯•ä½ çš„ makefileä¼šæ˜¯å¾ˆæœ‰ ç”¨çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ çš„ç¯å¢ƒå˜é‡å¾ˆå¤æ‚çš„æ—¶å€™ã€‚</p>
<p><code>-q, --question</code><br>
ä¸è¿è¡Œå‘½ä»¤ï¼Œä¹Ÿä¸è¾“å‡ºã€‚ä»…ä»…æ˜¯æ£€æŸ¥æ‰€æŒ‡å®šçš„ç›®æ ‡æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å¦‚æœæ˜¯0åˆ™è¯´æ˜è¦æ›´æ–°ï¼Œå¦‚æœæ˜¯2åˆ™è¯´ æ˜æœ‰é”™è¯¯å‘ç”Ÿã€‚</p>
<p><code>-r, --no-builtin-rules</code><br>
ç¦æ­¢makeä½¿ç”¨ä»»ä½•éšå«è§„åˆ™ã€‚</p>
<p><code>-R, --no-builtin-variabes</code><br>
ç¦æ­¢makeä½¿ç”¨ä»»ä½•ä½œç”¨äºå˜é‡ä¸Šçš„éšå«è§„åˆ™ã€‚</p>
<p><code>-s, --silent, --quiet</code><br>
åœ¨å‘½ä»¤è¿è¡Œæ—¶ä¸è¾“å‡ºå‘½ä»¤çš„è¾“å‡ºã€‚</p>
<p><code>-S, --no-keep-going, --stop</code><br>
å–æ¶ˆâ€œ-kâ€é€‰é¡¹çš„ä½œç”¨ã€‚å› ä¸ºæœ‰äº›æ—¶å€™ï¼Œmakeçš„é€‰é¡¹æ˜¯ä»ç¯å¢ƒå˜é‡â€œMAKEFLAGSâ€ä¸­ç»§æ‰¿ä¸‹æ¥çš„ã€‚æ‰€ä»¥ä½  å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨è¿™ä¸ªå‚æ•°æ¥è®©ç¯å¢ƒå˜é‡ä¸­çš„â€œ-kâ€é€‰é¡¹å¤±æ•ˆã€‚</p>
<p><code>-t, --touch</code><br>
ç›¸å½“äºUNIXçš„touchå‘½ä»¤ï¼Œåªæ˜¯æŠŠç›®æ ‡çš„ä¿®æ”¹æ—¥æœŸå˜æˆæœ€æ–°çš„ï¼Œä¹Ÿå°±æ˜¯é˜»æ­¢ç”Ÿæˆç›®æ ‡çš„å‘½ä»¤è¿è¡Œã€‚</p>
<p><code>-v, --version</code><br>
è¾“å‡ºmakeç¨‹åºçš„ç‰ˆæœ¬ã€ç‰ˆæƒç­‰å…³äºmakeçš„ä¿¡æ¯ã€‚</p>
<p><code>-w, --print-directory</code><br>
è¾“å‡ºè¿è¡Œmakefileä¹‹å‰å’Œä¹‹åçš„ä¿¡æ¯ã€‚è¿™ä¸ªå‚æ•°å¯¹äºè·Ÿè¸ªåµŒå¥—å¼è°ƒç”¨makeæ—¶å¾ˆæœ‰ç”¨ã€‚</p>
<p><code>--no-print-directory</code><br>
ç¦æ­¢â€œ-wâ€é€‰é¡¹ã€‚</p>
<p><code>-W &lt;file&gt;, --what-if=&lt;file&gt;, --new-file=&lt;file&gt;, --assume-file=&lt;file&gt;</code><br>
å‡å®šç›®æ ‡<file>;éœ€è¦æ›´æ–°ï¼Œå¦‚æœå’Œâ€œ-nâ€é€‰é¡¹ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¼šè¾“å‡ºè¯¥ç›®æ ‡æ›´æ–°æ—¶çš„è¿è¡ŒåŠ¨ä½œã€‚ å¦‚æœæ²¡æœ‰â€œ-nâ€é‚£ä¹ˆå°±åƒè¿è¡ŒUNIXçš„â€œtouchâ€å‘½ä»¤ä¸€æ ·ï¼Œä½¿å¾—<file>;çš„ä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´ã€‚</p>
<p><code>--warn-undefined-variables</code><br>
åªè¦makeå‘ç°æœ‰æœªå®šä¹‰çš„å˜é‡ï¼Œé‚£ä¹ˆå°±è¾“å‡ºè­¦å‘Šä¿¡æ¯ã€‚</p>
<h2 id="éšå«è§„åˆ™">éšå«è§„åˆ™</h2>
<p>éšå«è§„åˆ™æ¶µç›–å¾ˆå¤šï¼Œåœ¨æ­¤ä¹‹é˜è¿°æ¨¡æ¿è§„åˆ™å’Œè‡ªåŠ¨åŒ–å˜é‡</p>
<h3 id="æ¨¡æ¿è§„åˆ™">æ¨¡æ¿è§„åˆ™</h3>
<h4 id="è§„åˆ™">è§„åˆ™</h4>
<p>å³è§„åˆ™çš„ç›®æ ‡å®šä¹‰ä¸­å¿…é¡»åŒ…å« <code>%</code>ï¼Œ <code>%</code>è¡¨ç¤ºé•¿åº¦ä»»æ„çš„éç©ºå­—ç¬¦ä¸²ã€‚</p>
<pre><code>%.o : %.c ; &lt;command ......&gt;;
</code></pre>
<h4 id="ç¤ºä¾‹-5">ç¤ºä¾‹</h4>
<pre><code># æ‰€æœ‰åç¼€ä¸ºmtzä¾èµ–å…¶åç§°åç¼€ä¸ºzipæ–‡ä»¶
%.mtz : %.zip 
    # do someting
</code></pre>
<h3 id="è‡ªåŠ¨åŒ–å˜é‡">è‡ªåŠ¨åŒ–å˜é‡</h3>
<p><code>$@</code> : è¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æ–‡ä»¶é›†ã€‚åœ¨æ¨¡å¼è§„åˆ™ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªç›®æ ‡ï¼Œé‚£ä¹ˆï¼Œ <code>$@</code> å°±æ˜¯åŒ¹é…äºç›®æ ‡ä¸­æ¨¡å¼å®šä¹‰çš„é›†åˆã€‚</p>
<p><code>$%</code> : ä»…å½“ç›®æ ‡æ˜¯å‡½æ•°åº“æ–‡ä»¶ä¸­ï¼Œè¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æˆå‘˜åã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç›®æ ‡æ˜¯ <code>foo.a(bar.o)</code> ï¼Œ é‚£ä¹ˆï¼Œ <code>$%</code> å°±æ˜¯ <code>bar.o</code> ï¼Œ <code>$@</code> å°±æ˜¯ <code>foo.a</code>ã€‚å¦‚æœç›®æ ‡ä¸æ˜¯å‡½æ•°åº“æ–‡ä»¶ï¼ˆUnixä¸‹æ˜¯ <code>.a</code> ï¼ŒWindowsä¸‹æ˜¯ <code>.lib</code> ï¼‰ï¼Œé‚£ä¹ˆï¼Œå…¶å€¼ä¸ºç©ºã€‚</p>
<p><code>$&lt;</code> : ä¾èµ–ç›®æ ‡ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡åå­—ã€‚å¦‚æœä¾èµ–ç›®æ ‡æ˜¯ä»¥æ¨¡å¼ï¼ˆå³ <code>%</code> ï¼‰å®šä¹‰çš„ï¼Œé‚£ä¹ˆ <code>$&lt;</code> å°†æ˜¯ç¬¦åˆæ¨¡å¼çš„ä¸€ç³»åˆ—çš„æ–‡ä»¶é›†ã€‚æ³¨æ„ï¼Œå…¶æ˜¯ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥çš„ã€‚</p>
<p><code>$?</code> : æ‰€æœ‰æ¯”ç›®æ ‡æ–°çš„ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p>
<p><code>$^</code> : æ‰€æœ‰çš„ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚å¦‚æœåœ¨ä¾èµ–ç›®æ ‡ä¸­æœ‰å¤šä¸ªé‡å¤çš„ï¼Œé‚£ä¸ªè¿™ä¸ªå˜é‡ä¼šå»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡ï¼Œåªä¿ç•™ä¸€ä»½ã€‚</p>
<p><code>$+</code>: è¿™ä¸ªå˜é‡å¾ˆåƒ <code>$^</code> ï¼Œä¹Ÿæ˜¯æ‰€æœ‰ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚åªæ˜¯å®ƒä¸å»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡ã€‚</p>
<p><code>$*</code> : è¿™ä¸ªå˜é‡è¡¨ç¤ºç›®æ ‡æ¨¡å¼ä¸­ <code>%</code> åŠå…¶ä¹‹å‰çš„éƒ¨åˆ†ã€‚å¦‚æœç›®æ ‡æ˜¯ <code>dir/a.foo.b</code> ï¼Œå¹¶ä¸”ç›®æ ‡çš„æ¨¡å¼æ˜¯ <code>a.%.b</code> ï¼Œé‚£ä¹ˆï¼Œ <code>$*</code> çš„å€¼å°±æ˜¯ <code>dir/a.foo</code> ã€‚è¿™ä¸ªå˜é‡å¯¹äºæ„é€ æœ‰å…³è”çš„æ–‡ä»¶åæ˜¯æ¯”è¾ƒæœ‰æ•ˆã€‚å¦‚æœç›®æ ‡ä¸­æ²¡æœ‰æ¨¡å¼çš„å®šä¹‰ï¼Œé‚£ä¹ˆ <code>$*</code> ä¹Ÿå°±ä¸èƒ½è¢«æ¨å¯¼å‡ºï¼Œä½†æ˜¯ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶çš„åç¼€æ˜¯makeæ‰€è¯†åˆ«çš„ï¼Œé‚£ä¹ˆ <code>$*</code> å°±æ˜¯é™¤äº†åç¼€çš„é‚£ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼šå¦‚æœç›®æ ‡æ˜¯ <code>foo.c</code> ï¼Œå› ä¸º <code>.c</code> æ˜¯makeæ‰€èƒ½è¯†åˆ«çš„åç¼€åï¼Œæ‰€ä»¥ï¼Œ <code>$*</code> çš„å€¼å°±æ˜¯ <code>foo</code> ã€‚è¿™ä¸ªç‰¹æ€§æ˜¯GNU makeçš„ï¼Œ å¾ˆæœ‰å¯èƒ½ä¸å…¼å®¹äºå…¶å®ƒç‰ˆæœ¬çš„makeï¼Œæ‰€ä»¥ï¼Œä½ åº”è¯¥å°½é‡é¿å…ä½¿ç”¨ <code>$*</code> ï¼Œé™¤éæ˜¯åœ¨éšå«è§„åˆ™æˆ–æ˜¯é™æ€æ¨¡å¼ä¸­ã€‚å¦‚æœç›®æ ‡ä¸­çš„åç¼€æ˜¯makeæ‰€ä¸èƒ½è¯†åˆ«çš„ï¼Œé‚£ä¹ˆ <code>$*</code> å°±æ˜¯ç©ºå€¼ã€‚</p>
<p>é’ˆå¯¹äºä»¥ä¸Šå˜é‡å¯ä»¥å¢åŠ  <code>D</code> <code>F</code> å­—æ ·ã€‚<br>
<code>D</code> dir  å–ç›®å½•éƒ¨åˆ†<br>
<code>F</code>  file å–æ–‡ä»¶éƒ¨åˆ†</p>
<p><code>$(@D)</code><br>
è¡¨ç¤º <code>$@</code>çš„ç›®å½•éƒ¨åˆ†ï¼ˆä¸ä»¥æ–œæ ä½œä¸ºç»“å°¾ï¼‰ï¼Œå¦‚æœ <code>$@</code> å€¼æ˜¯ <code>dir/foo.o</code> ï¼Œé‚£ä¹ˆ <code>$(@D)</code> å°±æ˜¯ <code>dir</code> ï¼Œè€Œå¦‚æœ <code>$@</code>ä¸­æ²¡æœ‰åŒ…å«æ–œæ çš„è¯ï¼Œå…¶å€¼å°±æ˜¯ <code>.</code> ï¼ˆå½“å‰ç›®å½•ï¼‰ã€‚</p>
<p><code>$(@F)</code><br>
è¡¨ç¤º <code>$@</code> çš„æ–‡ä»¶éƒ¨åˆ†ï¼Œå¦‚æœ <code>$@</code>å€¼æ˜¯ <code>dir/foo.o</code> ï¼Œé‚£ä¹ˆ <code>$(@F)</code> å°±æ˜¯ <code>foo.o</code> ï¼Œ <code>$(@F)</code> ç›¸å½“äºå‡½æ•° <code>$(notdir $@)</code> ã€‚</p>
<h2 id="åè®°">åè®°</h2>
<p>åŸä½œè€…ï¼š<br>
é™ˆçš“ï¼š<a href="https://coolshell.cn/haoel">https://coolshell.cn/haoel </a><br>
ã€Šè·Ÿæˆ‘ä¸€èµ·å†™Makefileã€‹2004å¹´</p>
<p>æ’ç‰ˆï¼š<br>
miui-songhangï¼š<a href="https://github.com/songhanghang">https://github.com/songhanghang</a></p>
<p>è†œæ‹œå…ˆè¾ˆï¼ï¼ï¼<br>
æœ¬æ–‡æŒ‰ <code>ä»£ç  + æ³¨é‡Š</code> çš„æ€è·¯é‡æ–°æ•´ç†ï¼Œå‰”é™¤ä¸€äº›ç« èŠ‚å’Œè§£é‡Šï¼ŒåŠ å…¥ä¸€äº›è‡ªå·±çš„ç†è§£ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ã€‚</p>
<!-- æ’ç‰ˆ MIUI-THEME-å®‹èˆª -->
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Goaway è¿œç¦»æ‰‹æœº]]></title>
        <id>https://songhanghang.github.io/post/goaway-yuan-chi-shou-ji</id>
        <link href="https://songhanghang.github.io/post/goaway-yuan-chi-shou-ji">
        </link>
        <updated>2018-04-05T12:09:18.000Z</updated>
        <summary type="html"><![CDATA[<p>è¿™æ˜¯ä¸€æ¬¾æœ‰æ„æ€çš„é˜²æ²‰è¿·åº”ç”¨...<br>
æ—¶åˆ»æé†’æ¶ˆè€—åœ¨æ‰‹æœºä¸Šçš„æ—¶é—´ï¼Œ<br>
ç‚¹äº®å…³é—­é—´å¸®ä½ è®°å½•æ—¶é—´ï¼Œ</p>
]]></summary>
        <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€æ¬¾æœ‰æ„æ€çš„é˜²æ²‰è¿·åº”ç”¨...<br>
æ—¶åˆ»æé†’æ¶ˆè€—åœ¨æ‰‹æœºä¸Šçš„æ—¶é—´ï¼Œ<br>
ç‚¹äº®å…³é—­é—´å¸®ä½ è®°å½•æ—¶é—´ï¼Œ<br>
<!-- more --><br>
åº•éƒ¨tipså‘ŠçŸ¥ä½ å½“å‰çŠ¶æ€ï¼Œ<br>
äº”å½©å£çº¸éšç€ä½¿ç”¨æ—¶é—´é€æ¸å˜åŒ–ï¼Œ<br>
é•¿æŒ‰æ˜¾ç¤ºå„ä¸ªappçš„ä½¿ç”¨æ’åï¼Œ<br>
æ—¶åˆ»è­¦ç¤ºä½ æ”¾ä¸‹æ‰‹æœºï¼</p>
<h1 id="20-ä¸‹è½½">2.0 ä¸‹è½½</h1>
<p><a href="https://www.coolapk.com/apk/226765">ç‚¹è¿™Download https://www.coolapk.com/apk/226765</a></p>
<h1 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h1>
<ol>
<li>é€‚é…ç”¨çš„æ˜¯miuiï¼Œå…¶ä»–æ‰‹æœºæ¬¢è¿åé¦ˆ...</li>
<li>miuiä¸ºçœç”µä¼˜åŒ–ï¼Œåå°é»˜è®¤ä¼šå†»ç»“ä¸€äº›èƒ½åŠ›ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æ‰“å¼€ï¼Œ<code>è¿›å…¥ è®¾ç½®-&gt;ç”µé‡å’Œæ€§èƒ½-&gt;çœç”µä¼˜åŒ–-&gt;åº”ç”¨æ™ºèƒ½çœç”µ-&gt;è¿œç¦»æ‰‹æœºï¼ˆè¯¥appï¼‰-&gt;ç‚¹å‡»è¿›å…¥åå°é…ç½®-&gt;æ— é™åˆ¶</code> ï¼ˆè¯¥appåŠŸèƒ½ç®€å•ï¼Œåˆ·æ–°é¢‘ç‡ä½ï¼Œä¸ä¼šè€—ç”µï¼Œæ¬¢è¿ç›‘ç£ï¼‰</li>
</ol>
<h1 id="20-æ›´æ–°è¯´æ˜">2.0 æ›´æ–°è¯´æ˜</h1>
<ul>
<li>20180311 version 3</li>
</ul>
<ol>
<li>å…¨æ–°é¦–é¡µ</li>
<li>æ›´æ–°é»˜è®¤é¢œè‰²åŠæ–‡æ¡ˆ</li>
<li>æ”¯æŒå…¨éƒ¨appçš„ä½¿ç”¨æ’åå±•ç¤º</li>
</ol>
<ul>
<li>20180305 version 2</li>
</ul>
<ol>
<li>æ”¯æŒè‡ªå®šä¹‰æç¤ºåŠæ˜¾ç¤ºä½ç½®</li>
<li>æ”¯æŒè‡ªå®šä¹‰ Material design èƒŒæ™¯é¢œè‰²</li>
<li>æ”¯æŒé•¿æŒ‰å£çº¸æ˜¾ç¤ºå„ä¸ªappä½¿ç”¨æ’å</li>
</ol>
<ul>
<li>20180302 version 1</li>
</ul>
<ol>
<li>é€‚é…å°ç±³å…¨é¢å±æ‰‹æœº</li>
<li>é€‚é…è™šæ‹Ÿé”®æ‰‹æœº</li>
<li>fix é‡å¯æ‰‹æœºæ— æ³•æ˜¾ç¤ºæ—¶é—´æç¤º</li>
</ol>
<h1 id="å¼€æºå£°æ˜">å¼€æºå£°æ˜</h1>
<p><a href="https://github.com/songhanghang/goaway">github: https://github.com/songhanghang/goaway </a><br>
æ„Ÿè°¢<a href="https://github.com/LeeReindeer">LeeReindeeråŒå­¦è´¡çŒ®</a><br>
è¯¥appæ— ä»»ä½•æ¶æ„è¡Œä¸ºï¼Œä»£ç åœ¨æ­¤å¼€æºï¼Œæ¬¢è¿ç›‘ç£ã€‚<br>
å¦‚æœ‰äºŒæ¬¡å¼€å‘ï¼Œæœ›åŠ ä¸Šå‡ºå¤„ï¼Œä¸èƒœæ„Ÿè°¢ï¼</p>
<h1 id="èµ·å› ">èµ·å› </h1>
<p>ä½å¤´ä¸è§æŠ¬å¤´è§ï¼Œ</p>
<p>æœ‰äº†æ‰‹æœºï¼Œ</p>
<p>æ°¸ä¸ç›¸è§...</p>
<p>å„ç§appèš•é£Ÿæ—¶é—´ï¼Œ</p>
<p>ä¸çŸ¥ä¸è§‰é—´ï¼Œ</p>
<p>æ‰‹æœºåˆæ²¡ç”µ...</p>
<p>æˆ‘æƒ³é‡åŒ–æ—¶é—´ï¼</p>
<p>ä¸ºä½•æ‰‹æœºä¸èƒ½æœ‰é˜²æ²‰è¿·è®¾ç½®ï¼Ÿ</p>
<p>äºæ˜¯æœ‰äº†è¿™ä¸ªapp...</p>
<h1 id="è”ç³»æ–¹å¼">è”ç³»æ–¹å¼</h1>
<p><a href="http://songhang.club">æˆ‘çš„åšå®¢ï¼š songhang.club</a></p>
<p>é‚®ç®±: 1131442853@qq.com</p>
<p><a href="https://github.com/songhanghang">github: https://github.com/songhanghang</a><br>
<a href="https://github.com/LeeReindeer">LeeReindeer: https://github.com/LeeReindeer</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¦‚ä½•ä¿è¯ImageView.setImageResource()ä¼ å…¥.9å›¾ç‰‡æ—¶å±•ç¤ºæ­£å¸¸ï¼Ÿ]]></title>
        <id>https://songhanghang.github.io/post/ru-he-bao-zheng-imageviewsetimageresourcechuan-ru-9-tu-pian-shi-zhan-shi-zheng-chang</id>
        <link href="https://songhanghang.github.io/post/ru-he-bao-zheng-imageviewsetimageresourcechuan-ru-9-tu-pian-shi-zhan-shi-zheng-chang">
        </link>
        <updated>2017-08-09T12:14:53.000Z</updated>
        <summary type="html"><![CDATA[<meta name="referrer" content="no-referrer" />
> ImageViewå ä½å›¾å¯ä»¥é€šè¿‡backgroudè®¾ç½®.9å›¾ç‰‡å®ç°ï¼Œä½†æ˜¯åœ¨srcè®¾ç½®æˆå¸¦é€æ˜alphaå›¾ç‰‡æ—¶ä¼šé€è§†æ˜¾ç¤ºèƒŒæ™¯ï¼Œæ‰€ä»¥ç”¨srcå®ç°å ä½å›¾æ›´åˆç†ï¼Œä½†æ˜¯scaleTypeçš„è£å‰ªæ–¹å¼åŒæ ·ä¼šå½±å“åˆ°ä½œä¸ºsrcçš„.9å›¾ç‰‡,è¿™å°†ä¼šå¯¼è‡´.9å›¾ç‰‡ä¸èƒ½æŒ‰ç…§é¢„æœŸå±•ç¤ºå ä½å›¾]]></summary>
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" />
> ImageViewå ä½å›¾å¯ä»¥é€šè¿‡backgroudè®¾ç½®.9å›¾ç‰‡å®ç°ï¼Œä½†æ˜¯åœ¨srcè®¾ç½®æˆå¸¦é€æ˜alphaå›¾ç‰‡æ—¶ä¼šé€è§†æ˜¾ç¤ºèƒŒæ™¯ï¼Œæ‰€ä»¥ç”¨srcå®ç°å ä½å›¾æ›´åˆç†ï¼Œä½†æ˜¯scaleTypeçš„è£å‰ªæ–¹å¼åŒæ ·ä¼šå½±å“åˆ°ä½œä¸ºsrcçš„.9å›¾ç‰‡,è¿™å°†ä¼šå¯¼è‡´.9å›¾ç‰‡ä¸èƒ½æŒ‰ç…§é¢„æœŸå±•ç¤ºå ä½å›¾
<!-- more -->
<h2 id="ç°è±¡">ç°è±¡</h2>
<ul>
<li>
<p>ic_launcher.9.png<br>
<img src="http://imglf0.nosdn.127.net/img/Q3dzYVVKdDlxT21CTEpLdmhuT3VzVDl6Q0RsWVdKcGlGMWNnQThGbU90OS8wSFAzd1NUWDVBPT0.jpg?imageView&amp;thumbnail=500x0&amp;quality=96&amp;stripmeta=0&amp;type=jpg" alt=".9å›¾ç‰‡"></p>
</li>
<li>
<p>deafault&amp;centerCrop åŒæ ·è£å‰ªä¸­é—´æ˜¾ç¤º</p>
</li>
</ul>
<pre><code class="language-&lt;ImageView">        android:layout_width=&quot;200dp&quot;
        android:layout_height=&quot;200dp&quot;
        android:src=&quot;@drawable/ic_launcher&quot; /&gt;
</code></pre>
<pre><code class="language-&lt;ImageView">        android:layout_width=&quot;200dp&quot;
        android:layout_height=&quot;200dp&quot;
        android:scaleType=&quot;centerCrop&quot;
        android:src=&quot;@drawable/ic_launcher&quot; /&gt;
</code></pre>
<p><img src="http://imglf1.nosdn.127.net/img/Q3dzYVVKdDlxT21CTEpLdmhuT3VzVmloSGNFZldDOUcvMTcyeW5DUTlWS1IvREJyTGc1cWNnPT0.jpg?imageView&amp;thumbnail=500x0&amp;quality=96&amp;stripmeta=0&amp;type=jpg" alt="é»˜è®¤"></p>
<ul>
<li>fitXyæ˜¾ç¤ºå¦‚é¢„æœŸ</li>
</ul>
<pre><code>    &lt;ImageView
        android:layout_width=&quot;200dp&quot;
        android:layout_height=&quot;200dp&quot;
        android:scaleType=&quot;fitXY&quot;
        android:src=&quot;@drawable/ic_launcher&quot; /&gt;

</code></pre>
<p><img src="http://imglf2.nosdn.127.net/img/Q3dzYVVKdDlxT21CTEpLdmhuT3VzVFo5eTJUZTdmTDY4U2VWb3FUTVNCUUV4MXg0L216Ykx3PT0.jpg?imageView&amp;thumbnail=500x0&amp;quality=96&amp;stripmeta=0&amp;type=jpg" alt="fitxy"></p>
<h2 id="é—®é¢˜åˆ†æ-read-the-fucking-source-code">é—®é¢˜åˆ†æ (read the fucking source code)</h2>
<ol>
<li>mScaleTypeæ€ä¹ˆå‚ä¸å›¾ç‰‡è£å‰ªé€»è¾‘ï¼Ÿ</li>
<li>å›¾ç‰‡è£å‰ªåœ¨ä»€ä¹ˆæ—¶æœºæ‰§è¡Œï¼Ÿ</li>
<li>å¦‚ä½•å¹²é¢„è£å‰ªæ–¹å¼ï¼Ÿ</li>
</ol>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜å¾ˆç®€å•ImageView.configureBounds(), æ ¹æ®ä¸åŒçš„caseæä¾›ä¸åŒçš„æ¢ç®—ç­–ç•¥ï¼Œä½†æ˜¯googleç”¨privateå‘Šè¯‰ä½ ï¼Œå°å­è¿™ä¸ç»™ä½ æ”¹ï¼ï¼ï¼</p>
<pre><code>    private void configureBounds() {
          
            ...
        
            if (ScaleType.MATRIX == mScaleType) {
                // Use the specified matrix as-is.
                if (mMatrix.isIdentity()) {
                    mDrawMatrix = null;
                } else {
                    mDrawMatrix = mMatrix;
                }
            } else if (fits) {
                // The bitmap fits exactly, no transform needed.
                mDrawMatrix = null;
            } else if (ScaleType.CENTER == mScaleType) {
                // Center bitmap in view, no scaling.
                mDrawMatrix = mMatrix;
                mDrawMatrix.setTranslate(Math.round((vwidth - dwidth) * 0.5f),
                                         Math.round((vheight - dheight) * 0.5f));
            } else if (ScaleType.CENTER_CROP == mScaleType) {   
            ...
            } else if (ScaleType.CENTER_INSIDE == mScaleType) {
            ...
            } else {
            ...
            }
        }
    }
</code></pre>
<p>æ¥çœ‹ä¸‹ç¬¬äºŒä¸ªé—®é¢˜ï¼ŒconfigureBounds()éƒ½åœ¨å“ªè°ƒç”¨ï¼Ÿ</p>
<ol>
<li>setImageMatrix(...)</li>
<li>updateDrawable(...) &lt;-- setImageResource(...)</li>
<li>setFrame(...)</li>
</ol>
<p>åˆ†æä¸éš¾å‘ç°åœ¨ç»˜åˆ¶å‰è¿™1ï¼Œ2ä¸¤ä¸ªæ–¹æ³•å¹¶ä¸ä¼šè§¦å‘configureBounds(),æ‰€ä»¥é—®é¢˜æŒ‡å‘3,setFrameçš„è°ƒç”¨åœ¨Viewçš„layout(...)æ–¹æ³•ä¸­</p>
<pre><code>public void layout(int l, int t, int r, int b) {

...
        int oldL = mLeft;
        int oldT = mTop;
        int oldB = mBottom;
        int oldR = mRight;

        boolean changed = isLayoutModeOptical(mParent) ?
                setOpticalFrame(l, t, r, b) : setFrame(l, t, r, b);

...
        mPrivateFlags &amp;= ~PFLAG_FORCE_LAYOUT;
        mPrivateFlags3 |= PFLAG3_IS_LAID_OUT;
    }
</code></pre>
<p>è‡³æ­¤ä¸€å’ŒäºŒä¸¤ä¸ªé—®é¢˜è§£å¼€è¿·é›¾ï¼Œæ¢³ç†ä¸‹è°ƒç”¨æµç¨‹(-&gt; ä¸‹ä¸€ä¸ªæ–¹æ³• --&gt; æ–¹æ³•å†…è°ƒç”¨)</p>
<p>view-&gt;measure-&gt;layout--&gt;setFrame--&gt;configureBounds()-&gt;draw</p>
<p>ä¸éš¾åˆ†æåªæœ‰åœ¨layoutå’Œdrawä¹‹é—´åŠ¨åˆ€æ‰å¯ä»¥å¹²é¢„è£å‰ªæ–¹å¼ï¼Œlayoutå’ŒsetFrameéƒ½å¯ä»¥åˆ‡å…¥ï¼Œæ ¹æ®æœ€å°ä½œç”¨åŸŸåŸåˆ™ï¼Œæ›´é€‚åˆåœ¨setFrameå¤„ç†.</p>
<h2 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h2>
<p>è‡ªå®šä¹‰ImageViewé‡å†™setFrame()å¦‚ä¸‹</p>
<pre><code>public class NinePatchIamgeView extends ImageView {

    public NinePatchIamgeView(Context context) {
        super(context);
    }

    public NinePatchIamgeView(Context context, @Nullable AttributeSet attrs) {
        super(context, attrs);
    }

    public NinePatchIamgeView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    protected boolean setFrame(int l, int t, int r, int b) {
        // å½“å‰ScaleType
        ScaleType curScaleType = getScaleType();
        // .9å›¾ç‰‡è£å‰ªå‰è®¾ç½®ä¸´æ—¶ç±»å‹ScaleType.FIT_XY
        if (getDrawable() instanceof NinePatchDrawable) {
            setScaleType(ScaleType.FIT_XY);
        }
        boolean changed = super.setFrame(l, t, r, b);
        // è¿˜åŸScaleType
        setScaleType(curScaleType);
        return changed;
    }
}
</code></pre>
]]></content>
    </entry>
</feed>